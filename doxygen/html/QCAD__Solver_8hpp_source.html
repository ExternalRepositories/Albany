<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Albany: a Trilinos-based PDE code: QCAD_Solver.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>QCAD_Solver.hpp</h1>  </div>
</div>
<div class="contents">
<a href="QCAD__Solver_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************//</span>
<a name="l00002"></a>00002 <span class="comment">//    Albany 2.0:  Copyright 2012 Sandia Corporation               //</span>
<a name="l00003"></a>00003 <span class="comment">//    This Software is released under the BSD license detailed     //</span>
<a name="l00004"></a>00004 <span class="comment">//    in the file &quot;license.txt&quot; in the top-level Albany directory  //</span>
<a name="l00005"></a>00005 <span class="comment">//*****************************************************************//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef QCAD_SOLVER_H</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define QCAD_SOLVER_H</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;LOCA.H&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;LOCA_Epetra.H&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;Epetra_Vector.h&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;Epetra_LocalMap.h&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;LOCA_Epetra_ModelEvaluatorInterface.H&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;NOX_Epetra_MultiVector.H&gt;</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="Albany__ModelEvaluator_8hpp.html">Albany_ModelEvaluator.hpp</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="Albany__Utils_8hpp.html">Albany_Utils.hpp</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;Piro_Epetra_StokhosNOXObserver.hpp&quot;</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="QCAD__MultiSolutionObserver_8hpp.html">QCAD_MultiSolutionObserver.hpp</a>&quot;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#ifdef ALBANY_CI</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#include &quot;AlbanyCI_Types.hpp&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;AlbanyCI_Tensor.hpp&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;AlbanyCI_BlockTensor.hpp&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;AlbanyCI_SingleParticleBasis.hpp&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;AlbanyCI_BasisFactory.hpp&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;AlbanyCI_ManyParticleBasis.hpp&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;AlbanyCI_ManyParticleBasisBlock.hpp&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;AlbanyCI_MatrixFactory.hpp&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;AlbanyCI_ManyParticleMatrix.hpp&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;AlbanyCI_Solver.hpp&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;AlbanyCI_Solution.hpp&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;AlbanyCI_qnumbers.hpp&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#endif</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="keyword">namespace </span>QCAD {
<a name="l00043"></a>00043   <span class="keyword">class </span>SolverParamFn;
<a name="l00044"></a>00044   <span class="keyword">class </span>SolverResponseFn;
<a name="l00045"></a>00045   <span class="keyword">class </span>SolverSubSolver;
<a name="l00046"></a>00046   <span class="keyword">class </span>SolverSubSolverData;
<a name="l00047"></a>00047 
<a name="l00052"></a><a class="code" href="classQCAD_1_1Solver.html">00052</a>   <span class="keyword">class </span><a class="code" href="classQCAD_1_1Solver.html" title="Epetra-based Model Evaluator for QCAD solver.">Solver</a> : <span class="keyword">public</span> EpetraExt::ModelEvaluator {
<a name="l00053"></a>00053   <span class="keyword">public</span>:
<a name="l00054"></a>00054 
<a name="l00057"></a>00057 
<a name="l00058"></a>00058       <a class="code" href="classQCAD_1_1Solver.html#a6defaa35e1b9263e13b941dbc0a6a7f7">Solver</a>(<span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ac72c72afb7da5a0adcf02a0e202b4d92">appParams</a>,
<a name="l00059"></a>00059        <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>,
<a name="l00060"></a>00060        <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Vector&gt;&amp; initial_guess);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <a class="code" href="classQCAD_1_1Solver.html#a000e3e5c2fe8a243567bf31165ac5399">~Solver</a>();
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classQCAD_1_1Solver.html#aa3ad8db9473c93faf0d3893ee948304a">get_x_map</a>() <span class="keyword">const</span>;
<a name="l00066"></a>00066     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classQCAD_1_1Solver.html#a76c738fcf10fc0b84df713efeb801615">get_f_map</a>() <span class="keyword">const</span>;
<a name="l00067"></a>00067     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classQCAD_1_1Solver.html#acfc5535f1d6147f8bfa528d39c0371f5">get_p_map</a>(<span class="keywordtype">int</span> l) <span class="keyword">const</span>;
<a name="l00068"></a>00068     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classQCAD_1_1Solver.html#a31a6681ac0397f1aee4ed23337973b6c">get_g_map</a>(<span class="keywordtype">int</span> j) <span class="keyword">const</span>;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070     Teuchos::RCP&lt;const Epetra_Vector&gt; <a class="code" href="classQCAD_1_1Solver.html#aa7eda3f8a66d39062649cd082ea4b5a9">get_x_init</a>() <span class="keyword">const</span>;
<a name="l00071"></a>00071     Teuchos::RCP&lt;const Epetra_Vector&gt; <a class="code" href="classQCAD_1_1Solver.html#a688eec62b5c2c202a4f3055f754fa6d5">get_p_init</a>(<span class="keywordtype">int</span> l) <span class="keyword">const</span>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     EpetraExt::ModelEvaluator::InArgs <a class="code" href="classQCAD_1_1Solver.html#a32b8761fbb554e1264aa7f6978873b80">createInArgs</a>() <span class="keyword">const</span>;
<a name="l00074"></a>00074     EpetraExt::ModelEvaluator::OutArgs <a class="code" href="classQCAD_1_1Solver.html#aa791105858cf998cc45e6ea0de2f4c8c">createOutArgs</a>() <span class="keyword">const</span>;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#ab7d60f56690927f0fa9b617e339e9bf8">evalModel</a>( <span class="keyword">const</span> InArgs&amp; inArgs, <span class="keyword">const</span> OutArgs&amp; outArgs ) <span class="keyword">const</span>;    
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="keyword">private</span>:
<a name="l00080"></a>00080     Teuchos::RCP&lt;Teuchos::ParameterList&gt; <a class="code" href="classQCAD_1_1Solver.html#aa7fb202a7b5ea47bca4fd76eccf39877">createPoissonInputFile</a>(<span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; appParams,
<a name="l00081"></a>00081                 <span class="keywordtype">int</span> <a class="code" href="classQCAD_1_1Solver.html#a4d4879a6913ac217e826627ce473ee28">numDims</a>, <span class="keywordtype">int</span> nEigen, <span class="keyword">const</span> std::string&amp; specialProcessing,
<a name="l00082"></a>00082                 <span class="keyword">const</span> std::string&amp; xmlOutputFile, <span class="keyword">const</span> std::string&amp; exoOutputFile) <span class="keyword">const</span>;
<a name="l00083"></a>00083     Teuchos::RCP&lt;Teuchos::ParameterList&gt; <a class="code" href="classQCAD_1_1Solver.html#a524088eb44030587c3350f6973d57717">createSchrodingerInputFile</a>(<span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; appParams,
<a name="l00084"></a>00084                     <span class="keywordtype">int</span> numDims, <span class="keywordtype">int</span> nEigen, <span class="keyword">const</span> std::string&amp; specialProcessing,
<a name="l00085"></a>00085                     <span class="keyword">const</span> std::string&amp; xmlOutputFile, <span class="keyword">const</span> std::string&amp; exoOutputFile) <span class="keyword">const</span>;
<a name="l00086"></a>00086     Teuchos::RCP&lt;Teuchos::ParameterList&gt; <a class="code" href="classQCAD_1_1Solver.html#a8045c8cd15fd330b8ada7b4da9de46cb">createPoissonSchrodingerInputFile</a>(<span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; appParams,
<a name="l00087"></a>00087                      <span class="keywordtype">int</span> numDims, <span class="keywordtype">int</span> nEigen, <span class="keyword">const</span> std::string&amp; xmlOutputFile,
<a name="l00088"></a>00088                      <span class="keyword">const</span> std::string&amp; exoOutputFile) <span class="keyword">const</span>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#a2cea53b1c6fc886981425719a649365f">evalPoissonSchrodingerModel</a>(<span class="keyword">const</span> InArgs&amp; inArgs, <span class="keyword">const</span> OutArgs&amp; outArgs,
<a name="l00091"></a>00091              std::vector&lt;double&gt;&amp; eigenvalResponses, std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers) <span class="keyword">const</span>;
<a name="l00092"></a>00092     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#a77b8e58a567bf26850dc886df3a699b4">evalPoissonCIModel</a>(<span class="keyword">const</span> InArgs&amp; inArgs, <span class="keyword">const</span> OutArgs&amp; outArgs,
<a name="l00093"></a>00093           std::vector&lt;double&gt;&amp; eigenvalResponses, std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers) <span class="keyword">const</span>;
<a name="l00094"></a>00094     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#aad02fa0b215d6a041a253135574ef449">evalCIModel</a>(<span class="keyword">const</span> InArgs&amp; inArgs, <span class="keyword">const</span> OutArgs&amp; outArgs, 
<a name="l00095"></a>00095          std::vector&lt;double&gt;&amp; eigenvalResponses, std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers) <span class="keyword">const</span>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097     <span class="keywordtype">bool</span> <a class="code" href="classQCAD_1_1Solver.html#a469a2852f6cdf60bfbe522c100f31a1e">doPSLoop</a>(<span class="keyword">const</span> std::string&amp; mode, <span class="keyword">const</span> InArgs&amp; inArgs, std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers, 
<a name="l00098"></a>00098       Teuchos::RCP&lt;Albany::EigendataStruct&gt;&amp; eigenDataResult, <span class="keywordtype">bool</span> bPrintNumOfQuantumElectrons) <span class="keyword">const</span>;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#a1b0a78a5b0bf80b503b680c85da41f51">setupParameterMapping</a>(<span class="keyword">const</span> Teuchos::ParameterList&amp; list, <span class="keyword">const</span> std::string&amp; <a class="code" href="classQCAD_1_1Solver.html#a41a4b50d00e0f14928a52fed71255f28">defaultSubSolver</a>,
<a name="l00101"></a>00101              <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolverData&gt;&amp; subSolversData);
<a name="l00102"></a>00102     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#ab57521e4770e5dc4edb00a23b6c8972f">setupResponseMapping</a>(<span class="keyword">const</span> Teuchos::ParameterList&amp; list, <span class="keyword">const</span> std::string&amp; defaultSubSolver, <span class="keywordtype">int</span> nEigenvalues,
<a name="l00103"></a>00103             <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolverData&gt;&amp; subSolversData);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#a068e509f4a8a0d7d2539092f25919160">fillSingleSubSolverParams</a>(<span class="keyword">const</span> InArgs&amp; inArgs, <span class="keyword">const</span> std::string&amp; name, 
<a name="l00106"></a>00106            <a class="code" href="classQCAD_1_1SolverSubSolver.html">QCAD::SolverSubSolver</a>&amp; subSolver, <span class="keywordtype">int</span> nLeaveOffEnd=0) <span class="keyword">const</span>;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <a class="code" href="classQCAD_1_1SolverSubSolver.html">SolverSubSolver</a> <a class="code" href="classQCAD_1_1Solver.html#add339a8be54a9dd21f2387437c9b5a62">CreateSubSolver</a>(<span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt; appParams, <span class="keyword">const</span> Epetra_Comm&amp; comm,
<a name="l00109"></a>00109             <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Vector&gt;&amp; initial_guess  = Teuchos::null) <span class="keyword">const</span>;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <a class="code" href="classQCAD_1_1SolverSubSolverData.html">SolverSubSolverData</a> <a class="code" href="classQCAD_1_1Solver.html#ae488fff2b5e52095788f27e7c716d139">CreateSubSolverData</a>(<span class="keyword">const</span> <a class="code" href="classQCAD_1_1SolverSubSolver.html">QCAD::SolverSubSolver</a>&amp; sub) <span class="keyword">const</span>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; <a class="code" href="classQCAD_1_1Solver.html#a19cbbc17d92ed1e98913a02a262fb1fb">getSubSolverParams</a>(<span class="keyword">const</span> std::string&amp; name) <span class="keyword">const</span>;
<a name="l00115"></a>00115     Teuchos::RCP&lt;const Teuchos::ParameterList&gt; <a class="code" href="classQCAD_1_1Solver.html#a5be3d4a3fd4fccd757156a01dc313a3a">getValidProblemParameters</a>() <span class="keyword">const</span>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1Solver.html#ad9e90b8a0542240bab05e5bc857cbfb3">printResponses</a>(<span class="keyword">const</span> <a class="code" href="classQCAD_1_1SolverSubSolver.html">QCAD::SolverSubSolver</a>&amp; <a class="code" href="felix__driver_8cpp.html#a972cd8f5f47d36a2a3cea6e71a0ffa11">solver</a>, 
<a name="l00118"></a>00118       <span class="keyword">const</span> std::string&amp; solverName, 
<a name="l00119"></a>00119       Teuchos::RCP&lt;Teuchos::FancyOStream&gt; out) <span class="keyword">const</span>;
<a name="l00120"></a>00120     
<a name="l00121"></a>00121   <span class="keyword">private</span>:
<a name="l00122"></a><a class="code" href="classQCAD_1_1Solver.html#a4d4879a6913ac217e826627ce473ee28">00122</a>     <span class="keywordtype">int</span> numDims;
<a name="l00123"></a><a class="code" href="classQCAD_1_1Solver.html#a60b5fd80fd8954e38f5343b00edc3b66">00123</a>     std::string <a class="code" href="classQCAD_1_1Solver.html#a60b5fd80fd8954e38f5343b00edc3b66">problemNameBase</a>;
<a name="l00124"></a><a class="code" href="classQCAD_1_1Solver.html#a41a4b50d00e0f14928a52fed71255f28">00124</a>     std::string defaultSubSolver;
<a name="l00125"></a><a class="code" href="classQCAD_1_1Solver.html#a2ee2770a36a76cd395fbafdaf3e39b1b">00125</a>     Teuchos::RCP&lt;Teuchos::ParameterList&gt; <a class="code" href="classQCAD_1_1Solver.html#a2ee2770a36a76cd395fbafdaf3e39b1b">mainAppParams</a>;
<a name="l00126"></a><a class="code" href="classQCAD_1_1Solver.html#a4e00f97e0f8e496f2cb9bbcea457e17a">00126</a>     std::map&lt;std::string, Teuchos::RCP&lt;Teuchos::ParameterList&gt; &gt; <a class="code" href="classQCAD_1_1Solver.html#a4e00f97e0f8e496f2cb9bbcea457e17a">subProblemAppParams</a>;
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="classQCAD_1_1Solver.html#afa8b0640fe5453fbd8e9f85974b109e2">00128</a>     std::vector&lt; std::vector&lt;Teuchos::RCP&lt;SolverParamFn&gt; &gt; &gt; <a class="code" href="classQCAD_1_1Solver.html#afa8b0640fe5453fbd8e9f85974b109e2">paramFnVecs</a>;
<a name="l00129"></a><a class="code" href="classQCAD_1_1Solver.html#aa1d229305bf76a8a862aa56267b8ebc5">00129</a>     std::vector&lt;Teuchos::RCP&lt;SolverResponseFn&gt; &gt; <a class="code" href="classQCAD_1_1Solver.html#aa1d229305bf76a8a862aa56267b8ebc5">responseFns</a>;
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="classQCAD_1_1Solver.html#a15be423e323cf75236a76d55bd146395">00131</a>     std::size_t <a class="code" href="classQCAD_1_1Solver.html#a15be423e323cf75236a76d55bd146395">maxIter</a>;
<a name="l00132"></a><a class="code" href="classQCAD_1_1Solver.html#a510b6d4f11b9304d6737d75878456d27">00132</a>     std::size_t <a class="code" href="classQCAD_1_1Solver.html#a510b6d4f11b9304d6737d75878456d27">nParameters</a>;
<a name="l00133"></a><a class="code" href="classQCAD_1_1Solver.html#a61daa2849a6bf8b1e9721af8cef9cc0e">00133</a>     std::size_t <a class="code" href="classQCAD_1_1Solver.html#a61daa2849a6bf8b1e9721af8cef9cc0e">nResponseDoubles</a>;    
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classQCAD_1_1Solver.html#a2ef58ab22f2ee8cb5b80bda03d3fd20b">00135</a>     std::string <a class="code" href="classQCAD_1_1Solver.html#a2ef58ab22f2ee8cb5b80bda03d3fd20b">iterationMethod</a>;
<a name="l00136"></a><a class="code" href="classQCAD_1_1Solver.html#a9cb7864bf416222b75ad1d0bf367d2cc">00136</a>     <span class="keywordtype">int</span>  <a class="code" href="classQCAD_1_1Solver.html#a9cb7864bf416222b75ad1d0bf367d2cc">nEigenvectors</a>; <span class="comment">//used in Poisson-CI coupling</span>
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classQCAD_1_1Solver.html#a043fcc13189fe2d62d975aec61a9e10d">00138</a>     <span class="keywordtype">int</span> <a class="code" href="classQCAD_1_1Solver.html#a043fcc13189fe2d62d975aec61a9e10d">num_p</a>, <a class="code" href="classQCAD_1_1Solver.html#acd9808f54ac3187737715fb7d3a9b914">num_g</a>;
<a name="l00139"></a><a class="code" href="classQCAD_1_1Solver.html#a7c0db7e7ded700385b874b15c8b4c948">00139</a>     Teuchos::RCP&lt;Epetra_LocalMap&gt; <a class="code" href="classQCAD_1_1Solver.html#a7c0db7e7ded700385b874b15c8b4c948">epetra_param_map</a>;
<a name="l00140"></a><a class="code" href="classQCAD_1_1Solver.html#a474dc3878958aee4dd7959ee087a23e3">00140</a>     Teuchos::RCP&lt;Epetra_LocalMap&gt; <a class="code" href="classQCAD_1_1Solver.html#a474dc3878958aee4dd7959ee087a23e3">epetra_response_map</a>;
<a name="l00141"></a><a class="code" href="classQCAD_1_1Solver.html#a3aa1441305ef6a637d644b435c399cb5">00141</a>     Teuchos::RCP&lt;Epetra_Map&gt; <a class="code" href="classQCAD_1_1Solver.html#a3aa1441305ef6a637d644b435c399cb5">epetra_x_map</a>;
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classQCAD_1_1Solver.html#aa3d38109139b665097491b80a4f4efd6">00143</a>     Teuchos::RCP&lt;Epetra_Vector&gt; <a class="code" href="classQCAD_1_1Solver.html#aa3d38109139b665097491b80a4f4efd6">epetra_param_vec</a>;
<a name="l00144"></a><a class="code" href="classQCAD_1_1Solver.html#aee3a15cb457abbacc43f421c4001d50f">00144</a>     DerivativeSupport <a class="code" href="classQCAD_1_1Solver.html#aee3a15cb457abbacc43f421c4001d50f">deriv_support</a>;
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classQCAD_1_1Solver.html#adc3daca23f386a1d72ddc03543ff9235">00146</a>     Teuchos::RCP&lt;const Epetra_Comm&gt; <a class="code" href="classQCAD_1_1Solver.html#adc3daca23f386a1d72ddc03543ff9235">solverComm</a>;
<a name="l00147"></a><a class="code" href="classQCAD_1_1Solver.html#a99b2fe75abe0cbdbad44d9e97b3c834b">00147</a>     Teuchos::RCP&lt;const Epetra_Vector&gt; <a class="code" href="classQCAD_1_1Solver.html#a99b2fe75abe0cbdbad44d9e97b3c834b">saved_initial_guess</a>;
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="classQCAD_1_1Solver.html#a0742aa5d02798883a51f9a7bc96c40c2">00149</a>     <span class="keywordtype">bool</span> <a class="code" href="classQCAD_1_1Solver.html#a0742aa5d02798883a51f9a7bc96c40c2">bVerbose</a>;
<a name="l00150"></a><a class="code" href="classQCAD_1_1Solver.html#aee6304157aa8707a535cb4faa2c68d59">00150</a>     <span class="keywordtype">bool</span> <a class="code" href="classQCAD_1_1Solver.html#aee6304157aa8707a535cb4faa2c68d59">bSupportDpDg</a>;
<a name="l00151"></a><a class="code" href="classQCAD_1_1Solver.html#a09cc17461c8fb085ce4afe82b9f1c4c2">00151</a>     <span class="keywordtype">bool</span> <a class="code" href="classQCAD_1_1Solver.html#a09cc17461c8fb085ce4afe82b9f1c4c2">bRealEvecs</a>;
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="classQCAD_1_1Solver.html#a58646fdc49e4449a2c95716780049520">00153</a>     std::string <a class="code" href="classQCAD_1_1Solver.html#a58646fdc49e4449a2c95716780049520">eigensolverName</a>;
<a name="l00154"></a><a class="code" href="classQCAD_1_1Solver.html#ae2c3115a28fb80c97c6244596638d298">00154</a>     <span class="keywordtype">double</span> <a class="code" href="classQCAD_1_1Solver.html#ae2c3115a28fb80c97c6244596638d298">ps_converge_tol</a>;
<a name="l00155"></a><a class="code" href="classQCAD_1_1Solver.html#a3c27bfe3a44436fe505fc95a45fcff92">00155</a>     <span class="keywordtype">double</span> <a class="code" href="classQCAD_1_1Solver.html#a3c27bfe3a44436fe505fc95a45fcff92">shiftPercentBelowMin</a>;  <span class="comment">// for eigensolver shift-invert: shift point == minPotential * (1 + shiftPercent/100)</span>
<a name="l00156"></a><a class="code" href="classQCAD_1_1Solver.html#a672539dc6b3dad29a7bb832faf0e7de8">00156</a>     <span class="keywordtype">int</span>    <a class="code" href="classQCAD_1_1Solver.html#a672539dc6b3dad29a7bb832faf0e7de8">minCIParticles</a>;        <span class="comment">// the minimum number of particles allowed to be used in CI calculation</span>
<a name="l00157"></a><a class="code" href="classQCAD_1_1Solver.html#afc1c0777badc1c84dbc022534554de86">00157</a>     <span class="keywordtype">int</span>    <a class="code" href="classQCAD_1_1Solver.html#afc1c0777badc1c84dbc022534554de86">maxCIParticles</a>;        <span class="comment">// the maximum number of particles allowed to be used in CI calculation</span>
<a name="l00158"></a><a class="code" href="classQCAD_1_1Solver.html#a56168665d4c8b887c63642d5757bcce7">00158</a>     <span class="keywordtype">int</span>    <a class="code" href="classQCAD_1_1Solver.html#a56168665d4c8b887c63642d5757bcce7">nCIParticles</a>;          <span class="comment">// the number of particles used in CI calculation</span>
<a name="l00159"></a><a class="code" href="classQCAD_1_1Solver.html#af0cb709d9b72c6c8ac0dabe2e6705701">00159</a>     <span class="keywordtype">int</span>    <a class="code" href="classQCAD_1_1Solver.html#af0cb709d9b72c6c8ac0dabe2e6705701">nCIExcitations</a>;        <span class="comment">// the number of excitations used in CI calculation</span>
<a name="l00160"></a><a class="code" href="classQCAD_1_1Solver.html#adb72a1ec36c51757728ea110ec8b69e0">00160</a>     <span class="keywordtype">double</span> <a class="code" href="classQCAD_1_1Solver.html#adb72a1ec36c51757728ea110ec8b69e0">fixedPSOcc</a>;
<a name="l00161"></a><a class="code" href="classQCAD_1_1Solver.html#a5c7385d751631ca2ff25486b2bb1eb7b">00161</a>     <span class="keywordtype">bool</span>   <a class="code" href="classQCAD_1_1Solver.html#a5c7385d751631ca2ff25486b2bb1eb7b">bUseIntegratedPS</a>;
<a name="l00162"></a><a class="code" href="classQCAD_1_1Solver.html#a86eb36001eceabd7ff249a34d303fad7">00162</a>     <span class="keywordtype">bool</span>   <a class="code" href="classQCAD_1_1Solver.html#a86eb36001eceabd7ff249a34d303fad7">bUseTotalSpinSymmetry</a>; <span class="comment">// use S2 symmetry in CI calculation</span>
<a name="l00163"></a>00163   };
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="comment">// helper classes - maybe nest inside Solver?</span>
<a name="l00167"></a><a class="code" href="classQCAD_1_1SolverParamFn.html">00167</a>   <span class="keyword">class </span><a class="code" href="classQCAD_1_1SolverParamFn.html">SolverParamFn</a> {
<a name="l00168"></a>00168   <span class="keyword">public</span>:
<a name="l00169"></a>00169     <a class="code" href="classQCAD_1_1SolverParamFn.html#a52bb82d1e98636bcbe1f1aaee9dc7b07">SolverParamFn</a>(<span class="keyword">const</span> std::string&amp; fnString, 
<a name="l00170"></a>00170       <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolverData&gt;&amp; subSolversData);
<a name="l00171"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a7c7085fe56cb62ea8fb67f760e34710c">00171</a>     <a class="code" href="classQCAD_1_1SolverParamFn.html#a7c7085fe56cb62ea8fb67f760e34710c">~SolverParamFn</a>() {};
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#a26a169e1ead278dc1551f034667e1cbb">fillSingleSubSolverParams</a>(<span class="keywordtype">double</span> parameterValue, <span class="keyword">const</span> std::string&amp; subSolverName,
<a name="l00174"></a>00174            <a class="code" href="classQCAD_1_1SolverSubSolver.html">SolverSubSolver</a>&amp; subSolver) <span class="keyword">const</span>;
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#a5ffcfe14dee08187cf6f011fbcc25850">fillSubSolverParams</a>(<span class="keywordtype">double</span> parameterValue, 
<a name="l00177"></a>00177            <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers) <span class="keyword">const</span>;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keywordtype">double</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#a7c2b5da2726120791b03ace7d38417ca">getInitialParam</a>(<span class="keyword">const</span> std::map&lt;std::string, SolverSubSolverData&gt;&amp; subSolversData) <span class="keyword">const</span>;
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a511325a1b0a88e732bef6e9e245561e2">00181</a>     std::string <a class="code" href="classQCAD_1_1SolverParamFn.html#a511325a1b0a88e732bef6e9e245561e2">getTargetName</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#a8e7877da3cdef703e6ab1186c7413839">targetName</a>; }
<a name="l00182"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a835519c2c756eeb329bbb31dbd90239d">00182</a>     std::vector&lt;int&gt; <a class="code" href="classQCAD_1_1SolverParamFn.html#a835519c2c756eeb329bbb31dbd90239d">getTargetIndices</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#a3ac5bb1d8b8d06e2e46f4197f779ec2e">targetIndices</a>; }
<a name="l00183"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a2449279e2a53a9769b19f2c5b9b56c81">00183</a>     std::size_t <a class="code" href="classQCAD_1_1SolverParamFn.html#a2449279e2a53a9769b19f2c5b9b56c81">getNumFilters</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#aac179ad8d428702cabffd974e6b85cd6">filters</a>.size(); }
<a name="l00184"></a>00184     <span class="keywordtype">double</span> <a class="code" href="classQCAD_1_1SolverParamFn.html#abe7bcc47c8bfd62ed945a195426b4eee">getFilterScaling</a>() <span class="keyword">const</span>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="keyword">protected</span>:
<a name="l00187"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a8e7877da3cdef703e6ab1186c7413839">00187</a>     std::string <a class="code" href="classQCAD_1_1SolverParamFn.html#a8e7877da3cdef703e6ab1186c7413839">targetName</a>;
<a name="l00188"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#a3ac5bb1d8b8d06e2e46f4197f779ec2e">00188</a>     std::vector&lt;int&gt; <a class="code" href="classQCAD_1_1SolverParamFn.html#a3ac5bb1d8b8d06e2e46f4197f779ec2e">targetIndices</a>;
<a name="l00189"></a><a class="code" href="classQCAD_1_1SolverParamFn.html#aac179ad8d428702cabffd974e6b85cd6">00189</a>     std::vector&lt; std::vector&lt;std::string&gt; &gt; <a class="code" href="classQCAD_1_1SolverParamFn.html#aac179ad8d428702cabffd974e6b85cd6">filters</a>;
<a name="l00190"></a>00190   };
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html">00192</a>   <span class="keyword">class </span><a class="code" href="classQCAD_1_1SolverResponseFn.html">SolverResponseFn</a> {
<a name="l00193"></a>00193   <span class="keyword">public</span>:
<a name="l00194"></a>00194     <a class="code" href="classQCAD_1_1SolverResponseFn.html#ac9b67f57d4b0f3bff1db6670853f26b0">SolverResponseFn</a>(<span class="keyword">const</span> std::string&amp; fnString,
<a name="l00195"></a>00195          <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolverData&gt;&amp; subSolversData,
<a name="l00196"></a>00196          <span class="keywordtype">int</span> nEigenvalues);
<a name="l00197"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html#adb33af3b98f35268e02f53cb0522915e">00197</a>     <a class="code" href="classQCAD_1_1SolverResponseFn.html#adb33af3b98f35268e02f53cb0522915e">~SolverResponseFn</a>() {};
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1SolverResponseFn.html#a4170af719f5647c9f5e51c1a533455c9">fillSolverResponses</a>(Epetra_Vector&amp; <a class="code" href="namespaceFELIX.html#a6288e24787bb4182b95927dafefba8fe">g</a>, Teuchos::RCP&lt;Epetra_MultiVector&gt;&amp; dgdp, <span class="keywordtype">int</span> offset,
<a name="l00200"></a>00200            <span class="keyword">const</span> std::map&lt;std::string, SolverSubSolver&gt;&amp; subSolvers,
<a name="l00201"></a>00201            <span class="keyword">const</span> std::vector&lt;std::vector&lt;Teuchos::RCP&lt;SolverParamFn&gt; &gt; &gt;&amp; paramFnVecs,
<a name="l00202"></a>00202            <span class="keywordtype">bool</span> bSupportDpDg, <span class="keyword">const</span> std::vector&lt;double&gt;&amp; eigenvalueResponses) <span class="keyword">const</span>;
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html#a60e9af92b9dbd9d0983f81c924e513de">00204</a>     std::size_t <a class="code" href="classQCAD_1_1SolverResponseFn.html#a60e9af92b9dbd9d0983f81c924e513de">getNumDoubles</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classQCAD_1_1SolverResponseFn.html#a10a67dc042f2072e6ed2a67ae4b1dd83">numDoubles</a>; }
<a name="l00205"></a>00205 
<a name="l00206"></a>00206   <span class="keyword">protected</span>:
<a name="l00207"></a><a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html">00207</a>     <span class="keyword">struct </span><a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html">ArrayRef</a> { 
<a name="l00208"></a><a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html#ab23692e8e24f7368c48e4aed2c26b27a">00208</a>       std::string <a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html#ab23692e8e24f7368c48e4aed2c26b27a">name</a>; 
<a name="l00209"></a><a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html#a31cb6f9a8002b6a00e3a41e7f7731aed">00209</a>       std::vector&lt;int&gt; <a class="code" href="structQCAD_1_1SolverResponseFn_1_1ArrayRef.html#a31cb6f9a8002b6a00e3a41e7f7731aed">indices</a>;
<a name="l00210"></a>00210     };
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html#a390c11c03a35db1f4cf6745bc31e8241">00212</a>     std::string <a class="code" href="classQCAD_1_1SolverResponseFn.html#a390c11c03a35db1f4cf6745bc31e8241">fnName</a>;
<a name="l00213"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html#a14cf1e83a1a6c152e184e66406c27311">00213</a>     std::vector&lt;ArrayRef&gt; <a class="code" href="classQCAD_1_1SolverResponseFn.html#a14cf1e83a1a6c152e184e66406c27311">params</a>;
<a name="l00214"></a><a class="code" href="classQCAD_1_1SolverResponseFn.html#a10a67dc042f2072e6ed2a67ae4b1dd83">00214</a>     std::size_t <a class="code" href="classQCAD_1_1SolverResponseFn.html#a10a67dc042f2072e6ed2a67ae4b1dd83">numDoubles</a>; <span class="comment">//number of doubles produced by this response</span>
<a name="l00215"></a>00215   };
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html">00218</a>   <span class="keyword">class </span><a class="code" href="classQCAD_1_1SolverSubSolver.html">SolverSubSolver</a> {
<a name="l00219"></a>00219   <span class="keyword">public</span>:
<a name="l00220"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html#a5bd8ec3328bebe23a6bb6cf3d242c909">00220</a>     Teuchos::RCP&lt;Albany::Application&gt; <a class="code" href="classQCAD_1_1SolverSubSolver.html#a5bd8ec3328bebe23a6bb6cf3d242c909">app</a>;
<a name="l00221"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html#a4c4094c293ec37fc2cb92da0c332316b">00221</a>     Teuchos::RCP&lt;EpetraExt::ModelEvaluator&gt; <a class="code" href="classQCAD_1_1SolverSubSolver.html#a4c4094c293ec37fc2cb92da0c332316b">model</a>;
<a name="l00222"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html#a4e87b4016a3f5d9a6141b73e8f2e170a">00222</a>     Teuchos::RCP&lt;EpetraExt::ModelEvaluator::InArgs&gt; <a class="code" href="classQCAD_1_1SolverSubSolver.html#a4e87b4016a3f5d9a6141b73e8f2e170a">params_in</a>;
<a name="l00223"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html#a1c84a6a5bb3488a1b99aba274f875432">00223</a>     Teuchos::RCP&lt;EpetraExt::ModelEvaluator::OutArgs&gt; <a class="code" href="classQCAD_1_1SolverSubSolver.html#a1c84a6a5bb3488a1b99aba274f875432">responses_out</a>;
<a name="l00224"></a><a class="code" href="classQCAD_1_1SolverSubSolver.html#aeffb0b141a2eb9cab2bf44ed61760159">00224</a>     <span class="keywordtype">void</span> <a class="code" href="classQCAD_1_1SolverSubSolver.html#aeffb0b141a2eb9cab2bf44ed61760159">freeUp</a>() { <a class="code" href="classQCAD_1_1SolverSubSolver.html#a5bd8ec3328bebe23a6bb6cf3d242c909">app</a> = Teuchos::null; <a class="code" href="classQCAD_1_1SolverSubSolver.html#a4c4094c293ec37fc2cb92da0c332316b">model</a> = Teuchos::null; }
<a name="l00225"></a>00225   };
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="classQCAD_1_1SolverSubSolverData.html">00227</a>   <span class="keyword">class </span><a class="code" href="classQCAD_1_1SolverSubSolverData.html">SolverSubSolverData</a> {
<a name="l00228"></a>00228   <span class="keyword">public</span>:
<a name="l00229"></a><a class="code" href="classQCAD_1_1SolverSubSolverData.html#a02387d96fc46481037f6f804aa27826c">00229</a>     <span class="keywordtype">int</span> <a class="code" href="classQCAD_1_1SolverSubSolverData.html#a02387d96fc46481037f6f804aa27826c">Np</a>, <a class="code" href="classQCAD_1_1SolverSubSolverData.html#a01eb0175f4fe86b41c51ba3b36a6affc">Ng</a>;
<a name="l00230"></a><a class="code" href="classQCAD_1_1SolverSubSolverData.html#a2e31cc53de5abd36a2a46d9c1a56d6f4">00230</a>     std::vector&lt;int&gt; <a class="code" href="classQCAD_1_1SolverSubSolverData.html#a2e31cc53de5abd36a2a46d9c1a56d6f4">pLength</a>, <a class="code" href="classQCAD_1_1SolverSubSolverData.html#a7165dc9eb920579e98463e90ccecc708">gLength</a>;
<a name="l00231"></a><a class="code" href="classQCAD_1_1SolverSubSolverData.html#af9fcda6d6262369bfafe46f20fbf01f1">00231</a>     Teuchos::RCP&lt;const Epetra_Vector&gt; <a class="code" href="classQCAD_1_1SolverSubSolverData.html#af9fcda6d6262369bfafe46f20fbf01f1">p_init</a>;
<a name="l00232"></a><a class="code" href="classQCAD_1_1SolverSubSolverData.html#af9f89b8070807a4c11aa55d395c1c150">00232</a>     EpetraExt::ModelEvaluator::DerivativeSupport <a class="code" href="classQCAD_1_1SolverSubSolverData.html#af9f89b8070807a4c11aa55d395c1c150">deriv_support</a>;
<a name="l00233"></a>00233   };
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="preprocessor">#ifdef ALBANY_CI</span>
<a name="l00237"></a>00237 <span class="preprocessor"></span>  <span class="keyword">class </span>CISolver {
<a name="l00238"></a>00238   <span class="keyword">public</span>:
<a name="l00239"></a>00239     CISolver(<span class="keywordtype">int</span> n1PSpinlessStates, Teuchos::RCP&lt;const Epetra_Comm&gt; eComm, 
<a name="l00240"></a>00240        Teuchos::RCP&lt;Teuchos::FancyOStream&gt; outStream);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     Teuchos::RCP&lt;Teuchos::ParameterList&gt; getDefaultParameterList() <span class="keyword">const</span>;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="keywordtype">void</span> fill1Pmx(<span class="keyword">const</span> Teuchos::RCP&lt;Albany::EigendataStruct&gt;&amp; eigenData1P);
<a name="l00245"></a>00245     <span class="keywordtype">void</span> fill1Pmx(<span class="keyword">const</span> Teuchos::RCP&lt;Albany::EigendataStruct&gt;&amp; eigenData1P,
<a name="l00246"></a>00246       <span class="keyword">const</span> Teuchos::RCP&lt;Epetra_Vector&gt;&amp; g_noCharge,
<a name="l00247"></a>00247       <span class="keyword">const</span> Teuchos::RCP&lt;Epetra_Vector&gt;&amp; g_delta,
<a name="l00248"></a>00248       <span class="keywordtype">double</span> deltaScale, <span class="keywordtype">bool</span> bRealEvecs, <span class="keywordtype">bool</span> bVerbose);
<a name="l00249"></a>00249     <span class="keywordtype">void</span> fill2Pmx(Teuchos::RCP&lt;Albany::EigendataStruct&gt; eigenData1P,
<a name="l00250"></a>00250       <span class="keyword">const</span> <a class="code" href="classQCAD_1_1SolverSubSolver.html">SolverSubSolver</a>* coulombSolver, 
<a name="l00251"></a>00251       <span class="keyword">const</span> <a class="code" href="classQCAD_1_1SolverSubSolver.html">SolverSubSolver</a>* coulombSolver_ImPart,
<a name="l00252"></a>00252       <span class="keyword">const</span> Teuchos::RCP&lt;Epetra_Vector&gt;&amp; g_noCharge,
<a name="l00253"></a>00253       <span class="keywordtype">bool</span> bRealEvecs, <span class="keywordtype">bool</span> bVerbose);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     Teuchos::RCP&lt;AlbanyCI::Solution&gt; Solve(Teuchos::RCP&lt;Teuchos::ParameterList&gt; AlbanyCIList) <span class="keyword">const</span>;
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     Teuchos::RCP&lt;Epetra_MultiVector&gt; ComputeStateDensities(Teuchos::RCP&lt;Albany::EigendataStruct&gt; eigenData1P,
<a name="l00258"></a>00258                  Teuchos::RCP&lt;AlbanyCI::Solution&gt; soln);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="keyword">private</span>:
<a name="l00262"></a>00262     <span class="keywordtype">void</span> SetCoulombParams(<span class="keyword">const</span> Teuchos::RCP&lt;EpetraExt::ModelEvaluator::InArgs&gt; inArgs, <span class="keywordtype">int</span> i2, <span class="keywordtype">int</span> i4) <span class="keyword">const</span>;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   <span class="keyword">private</span>:
<a name="l00265"></a>00265     <span class="comment">// number of single particle states of each type of spin (up / down)</span>
<a name="l00266"></a>00266     <span class="keywordtype">int</span> n1PperBlock;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="comment">// 1P Blocks, accessed individually or as a vector</span>
<a name="l00269"></a>00269     Teuchos::RCP&lt;AlbanyCI::Tensor&lt;AlbanyCI::dcmplx&gt; &gt; blockU,blockD;
<a name="l00270"></a>00270     std::vector&lt;Teuchos::RCP&lt;AlbanyCI::Tensor&lt;AlbanyCI::dcmplx&gt; &gt; &gt; blocks1P;
<a name="l00271"></a>00271     Teuchos::RCP&lt;AlbanyCI::BlockTensor&lt;AlbanyCI::dcmplx&gt; &gt; mx1P;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <span class="comment">// 2P Blocks, accessed individually or as a vector</span>
<a name="l00274"></a>00274     Teuchos::RCP&lt;AlbanyCI::Tensor&lt;AlbanyCI::dcmplx&gt; &gt; blockUU, blockUD, blockDU, blockDD;
<a name="l00275"></a>00275     std::vector&lt;Teuchos::RCP&lt;AlbanyCI::Tensor&lt;AlbanyCI::dcmplx&gt; &gt; &gt; blocks2P;
<a name="l00276"></a>00276     Teuchos::RCP&lt;AlbanyCI::BlockTensor&lt;AlbanyCI::dcmplx&gt; &gt; mx2P;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     <span class="comment">// 1P basis</span>
<a name="l00279"></a>00279     Teuchos::RCP&lt;AlbanyCI::SingleParticleBasis&gt; basis1P;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <span class="comment">// MPI Comm</span>
<a name="l00282"></a>00282     Teuchos::RCP&lt;Teuchos::Comm&lt;int&gt; &gt; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>;    
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     <span class="comment">// Output stream</span>
<a name="l00285"></a>00285     Teuchos::RCP&lt;Teuchos::FancyOStream&gt; out;
<a name="l00286"></a>00286   };
<a name="l00287"></a>00287 <span class="preprocessor">#endif</span>
<a name="l00288"></a>00288 <span class="preprocessor"></span>  
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 26 2014 18:36:44 for Albany: a Trilinos-based PDE code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
