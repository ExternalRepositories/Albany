<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Albany: a Trilinos-based PDE code: AlbPUMI_FMDBDiscretization.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>AlbPUMI_FMDBDiscretization.hpp</h1>  </div>
</div>
<div class="contents">
<a href="AlbPUMI__FMDBDiscretization_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************//</span>
<a name="l00002"></a>00002 <span class="comment">//    Albany 2.0:  Copyright 2012 Sandia Corporation               //</span>
<a name="l00003"></a>00003 <span class="comment">//    This Software is released under the BSD license detailed     //</span>
<a name="l00004"></a>00004 <span class="comment">//    in the file &quot;license.txt&quot; in the top-level Albany directory  //</span>
<a name="l00005"></a>00005 <span class="comment">//*****************************************************************//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef ALBPUMI_FMDBDISCRETIZATION_HPP</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define ALBPUMI_FMDBDISCRETIZATION_HPP</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;Teuchos_ParameterList.hpp&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;Teuchos_VerboseObject.hpp&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;Epetra_Comm.h&quot;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;<a class="code" href="AlbPUMI__AbstractPUMIDiscretization_8hpp.html">AlbPUMI_AbstractPUMIDiscretization.hpp</a>&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;<a class="code" href="AlbPUMI__FMDBMeshStruct_8hpp.html">AlbPUMI_FMDBMeshStruct.hpp</a>&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="AlbPUMI__FMDBVtk_8hpp.html">AlbPUMI_FMDBVtk.hpp</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="AlbPUMI__FMDBExodus_8hpp.html">AlbPUMI_FMDBExodus.hpp</a>&quot;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;Piro_NullSpaceUtils.hpp&quot;</span> <span class="comment">// has defn of struct that holds null space info for ML</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;Epetra_CrsMatrix.h&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;Epetra_Vector.h&quot;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="keyword">namespace </span>AlbPUMI {
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Output&gt;
<a name="l00030"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html">00030</a>   <span class="keyword">class </span><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html">FMDBDiscretization</a> : <span class="keyword">public</span> <a class="code" href="classAlbPUMI_1_1AbstractPUMIDiscretization.html">AbstractPUMIDiscretization</a> {
<a name="l00031"></a>00031   <span class="keyword">public</span>:
<a name="l00032"></a>00032 
<a name="l00034"></a>00034     <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6e2d452eaae6a32de58f876bacc0a4d6" title="Constructor.">FMDBDiscretization</a>(
<a name="l00035"></a>00035        Teuchos::RCP&lt;AlbPUMI::FMDBMeshStruct&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5376a1c1a1d5e981aa4c945736f02090">fmdbMeshStruct</a>,
<a name="l00036"></a>00036        <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7d1190558a94ea348521bd01bbdfd2d7" title="Stk Mesh Objects.">comm</a>,
<a name="l00037"></a>00037        <span class="keyword">const</span> Teuchos::RCP&lt;Piro::MLRigidBodyModes&gt;&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acbd6df4cf191aee3e9c940da41e0aaa5">rigidBodyModes</a> = Teuchos::null);
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 
<a name="l00041"></a>00041     <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a737b33d93ad361667cfc24900fca73e4" title="Destructor.">~FMDBDiscretization</a>();
<a name="l00042"></a>00042 
<a name="l00044"></a>00044     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a98b04f0df78e70503be2046e2f088554" title="Get DOF map.">getMap</a>() <span class="keyword">const</span>;
<a name="l00045"></a>00045 
<a name="l00047"></a>00047     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a969b6ce104d49d56dd81cdb52dffbbd9" title="Get overlapped DOF map.">getOverlapMap</a>() <span class="keyword">const</span>;
<a name="l00048"></a>00048 
<a name="l00050"></a>00050     Teuchos::RCP&lt;const Epetra_CrsGraph&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a66e3a3ff55b65fabd09e1001d0710b5a" title="Get Jacobian graph.">getJacobianGraph</a>() <span class="keyword">const</span>;
<a name="l00051"></a>00051 
<a name="l00053"></a>00053     Teuchos::RCP&lt;const Epetra_CrsGraph&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a90022d314a98240d3af553c8676fbdd4" title="Get overlap Jacobian graph.">getOverlapJacobianGraph</a>() <span class="keyword">const</span>;
<a name="l00054"></a>00054 
<a name="l00056"></a>00056     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#abb9d708cf177a09bf8b90da0f8f7790e" title="Get Node map.">getNodeMap</a>() <span class="keyword">const</span>;
<a name="l00057"></a>00057 
<a name="l00059"></a>00059     Teuchos::RCP&lt;const Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a197c9c0f0990b01d6668cb83844c0d46" title="Get Overlap Node map.">getOverlapNodeMap</a>() <span class="keyword">const</span>;
<a name="l00060"></a>00060 
<a name="l00062"></a>00062     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aea4d7db03657daaef4208a7374114437" title="Process coords for ML.">setupMLCoords</a>();
<a name="l00063"></a>00063 
<a name="l00065"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a57a8900db0cd51620f44434303acef1e">00065</a>     <span class="keyword">const</span> <a class="code" href="namespaceAlbany.html#ac6fb9ef9b5bb66848b3ed2926c552894">Albany::NodeSetList</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a57a8900db0cd51620f44434303acef1e" title="Get Node set lists (typedef in Albany_AbstractDiscretization.hpp).">getNodeSets</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aeaa47b390cd04fd65f6812859cb04a28" title="node sets stored as std::map(string ID, int vector of GIDs)">nodeSets</a>; };
<a name="l00066"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af119a37809e9efc18a25cbd0994341d8">00066</a>     <span class="keyword">const</span> <a class="code" href="namespaceAlbany.html#ad41143a14c776475291e32beedece98a">Albany::NodeSetCoordList</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af119a37809e9efc18a25cbd0994341d8">getNodeSetCoords</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a085368c8fc8322335def4cec0330ecb4">nodeSetCoords</a>; };
<a name="l00067"></a>00067 
<a name="l00069"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a0e3f3ca76c4e7dbdc657c16cb10e4720">00069</a>     <span class="keyword">const</span> <a class="code" href="namespaceAlbany.html#aa0bc1b08430527fdeb81b86e76b48e1e">Albany::SideSetList</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a0e3f3ca76c4e7dbdc657c16cb10e4720" title="Get Side set lists (typedef in Albany_AbstractDiscretization.hpp).">getSideSets</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> workset)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7f3cbd9ccf42c181731d304cc46ee9ff" title="side sets stored as std::map(string ID, SideArray classes) per workset (std::vector across worksets)...">sideSets</a>[workset]; };
<a name="l00070"></a>00070 
<a name="l00072"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a1301d1a898d0599315808ba8b14271c1">00072</a>     <a class="code" href="namespaceAlbany.html#af11daa75105be6e470b4271a6a7295cb">Albany::WsLIDList</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a1301d1a898d0599315808ba8b14271c1" title="Get connectivity map from elementGID to workset.">getElemGIDws</a>() { <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a958245b7cbcec18441b5187f75eb40d2" title="Connectivity map from elementGID to workset and LID in workset.">elemGIDws</a>; };
<a name="l00073"></a>00073 
<a name="l00075"></a>00075     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;int&gt;</a> &gt; &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ac9883cdef268536e0fd2c2012cd45898" title="Get map from (Ws, El, Local Node) -&amp;gt; NodeLID.">getWsElNodeEqID</a>() <span class="keyword">const</span>;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;int&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aaf23db797367803ea700646e44ffb525">getWsElNodeID</a>() <span class="keyword">const</span>;
<a name="l00078"></a>00078 
<a name="l00080"></a>00080     Teuchos::ArrayRCP&lt;double&gt;&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae1b5a3fa5402be5ad8ff19b875f56ea3" title="Retrieve coodinate vector (num_used_nodes * 3).">getCoordinates</a>() <span class="keyword">const</span>;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a21e7b84a8f2a9f61d8efccd10664a7f1">getCoords</a>() <span class="keyword">const</span>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     <span class="comment">// FIXME - Dummy FELIX accessor functions</span>
<a name="l00085"></a>00085     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9a072ac4d0671d9c334ee63fb8342813">getSurfaceHeight</a>() <span class="keyword">const</span>;
<a name="l00086"></a>00086     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a67a9e8f3741be856e3fc0c71c24f7980">getTemperature</a>() <span class="keyword">const</span>;
<a name="l00087"></a>00087     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a1531d613b7319c7d6815274eec4073e4">getBasalFriction</a>() <span class="keyword">const</span>;
<a name="l00088"></a>00088     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#abe8ee17e39b16bbd3eb8679a2eb7085b">getThickness</a>() <span class="keyword">const</span>;
<a name="l00089"></a>00089     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a65182f3a5c9924df4026adacd941b4da">getSurfaceVelocity</a>() <span class="keyword">const</span>;
<a name="l00090"></a>00090     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a11cf14f8afc083e12d97cffe7710e42f">getVelocityRMS</a>() <span class="keyword">const</span>;
<a name="l00091"></a>00091     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt;::type&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aeec019cd80e3cb6039a4daa123d701d8">getFlowFactor</a>() <span class="keyword">const</span>;
<a name="l00092"></a>00092 
<a name="l00094"></a>00094     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a51044b622462125a882e7a9f22f086e2" title="Print coords for debugging.">printCoords</a>() <span class="keyword">const</span>;
<a name="l00095"></a>00095     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a07d6260870cfa3eeace18a66a1ac3442">debugMeshWriteNative</a>(<span class="keyword">const</span> Epetra_Vector&amp; sol, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename);
<a name="l00096"></a>00096     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a26bb4abefd272725a25c49d23fcd632b">debugMeshWrite</a>(<span class="keyword">const</span> Epetra_Vector&amp; sol, <span class="keyword">const</span> <span class="keywordtype">char</span>* filename);
<a name="l00097"></a>00097 
<a name="l00099"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a025ea6e06d0965243acf4907a9d13002">00099</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a025ea6e06d0965243acf4907a9d13002" title="Get number of spatial dimensions.">getNumDim</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> fmdbMeshStruct-&gt;numDim; }
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a67223dd2955878c245bb0555d3861da8">00101</a>     <span class="keyword">virtual</span> Teuchos::RCP&lt;const Epetra_Comm&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a67223dd2955878c245bb0555d3861da8">getComm</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> comm; }
<a name="l00102"></a>00102 
<a name="l00104"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a33a3d6a72503a1f8f82a9fbdaa4042e6">00104</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a33a3d6a72503a1f8f82a9fbdaa4042e6" title="Get number of total DOFs per node.">getNumEq</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3189db7ba940e93aa9643f8b8bae2fb5" title="Number of equations (and unknowns) per node.">neq</a>; }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6ffcc2638763714282f69ef3818fd19b">00106</a>     <a class="code" href="structAlbany_1_1StateArrays.html">Albany::StateArrays</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6ffcc2638763714282f69ef3818fd19b">getStateArrays</a>() {<span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a61b42aea7b0fbd9cdba6f73c02de5c55">stateArrays</a>;};
<a name="l00107"></a>00107 
<a name="l00109"></a>00109     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html#a2251678748f133c70ad2b97345319967">Albany::WorksetArray&lt;std::string&gt;::type</a>&amp;  <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a90671f96a46c17342e7402d1679b8547" title="Retrieve Vector (length num worksets) of element block names.">getWsEBNames</a>() <span class="keyword">const</span>;
<a name="l00111"></a>00111     <span class="keyword">const</span> <a class="code" href="structAlbany_1_1WorksetArray.html#a2251678748f133c70ad2b97345319967">Albany::WorksetArray&lt;int&gt;::type</a>&amp;  <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae05cd59ba8231a793ba056ac57d53adf" title="Retrieve Vector (length num worksets) of physics set index.">getWsPhysIndex</a>() <span class="keyword">const</span>;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a33c34d80625402c312949d013f6b62c3" title="Write the solution to the output file.">writeSolution</a>(<span class="keyword">const</span> Epetra_Vector&amp; soln, <span class="keyword">const</span> <span class="keywordtype">double</span> time, <span class="keyword">const</span> <span class="keywordtype">bool</span> overlapped = <span class="keyword">false</span>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     Teuchos::RCP&lt;Epetra_Vector&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa6c20a6f0de906ecde1902511126a29c" title="Get solution vector from mesh database.">getSolutionField</a>() <span class="keyword">const</span>;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae83d23ce766823ea38727d2bcb071e15" title="Set the residual field for output.">setResidualField</a>(<span class="keyword">const</span> Epetra_Vector&amp; residual);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="comment">// Retrieve mesh struct</span>
<a name="l00120"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a1d35bfc3ea8074d45f0962fcadb0f254">00120</a>     Teuchos::RCP&lt;AlbPUMI::FMDBMeshStruct&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a1d35bfc3ea8074d45f0962fcadb0f254">getFMDBMeshStruct</a>() {<span class="keywordflow">return</span> fmdbMeshStruct;}
<a name="l00121"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9466b8815883e24a6ce74c519dab560d">00121</a>     Teuchos::RCP&lt;Albany::AbstractMeshStruct&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9466b8815883e24a6ce74c519dab560d">getMeshStruct</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fmdbMeshStruct;}
<a name="l00122"></a>00122 
<a name="l00124"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af5d9a43e966ae3b5d23251006c01245f">00124</a>     <span class="keywordtype">bool</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af5d9a43e966ae3b5d23251006c01245f" title="Flag if solution has a restart values -- used in Init Cond.">hasRestartSolution</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fmdbMeshStruct-&gt;hasRestartSolution;}
<a name="l00125"></a>00125 
<a name="l00127"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a2f19926cca4d68ae114ca4f485224f0f">00127</a>     <span class="keywordtype">double</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a2f19926cca4d68ae114ca4f485224f0f" title="If restarting, convenience function to return restart data time.">restartDataTime</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fmdbMeshStruct-&gt;restartDataTime;}
<a name="l00128"></a>00128 
<a name="l00130"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3c6e136e4761bf82cf1a52d1eeb4932a">00130</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3c6e136e4761bf82cf1a52d1eeb4932a" title="FMDB does not support MOR.">supportsMOR</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">// After mesh modification, need to update the element connectivity and nodal coordinates</span>
<a name="l00133"></a>00133     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa946c104ba44f8873854f3c35d8f9e4e">updateMesh</a>();
<a name="l00134"></a>00134 
<a name="l00136"></a>00136     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a0b48f3d038947e9887e629f833c8408d" title="Accessor function to get coordinates for ML. Memory controlled here.">getOwned_xyz</a>(<span class="keywordtype">double</span> **x, <span class="keywordtype">double</span> **y, <span class="keywordtype">double</span> **z, <span class="keywordtype">double</span> **rbm,
<a name="l00137"></a>00137                       <span class="keywordtype">int</span>&amp; <a class="code" href="felix__driver_8cpp.html#ab5242add5962116d4d46270da25895b3">nNodes</a>, <span class="keywordtype">int</span> numPDEs, <span class="keywordtype">int</span> numScalar, <span class="keywordtype">int</span> nullSpaceDim);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="comment">// Function that transforms an FMDB mesh of a unit cube (for FELIX problems)</span>
<a name="l00140"></a>00140     <span class="comment">// not supported in FMDB now</span>
<a name="l00141"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9548fb1c3e1633ebc04e3715b2dc00e4">00141</a>     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9548fb1c3e1633ebc04e3715b2dc00e4">transformMesh</a>(){}
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b85ad0bf31e97a6acfe3b9720a59a71">00143</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b85ad0bf31e97a6acfe3b9720a59a71">getDOF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> inode, <span class="keyword">const</span> <span class="keywordtype">int</span> eq)<span class="keyword"> const</span>
<a name="l00144"></a>00144 <span class="keyword">    </span>{
<a name="l00145"></a>00145       <span class="keywordflow">if</span> (<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7ffb0250fce2e3b0eeebf79796007999">interleavedOrdering</a>) <span class="keywordflow">return</span> inode*<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3189db7ba940e93aa9643f8b8bae2fb5" title="Number of equations (and unknowns) per node.">neq</a> + eq;
<a name="l00146"></a>00146       <span class="keywordflow">else</span>  <span class="keywordflow">return</span> inode + <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a8dc79e9eaa2504fb986595892bab3013" title="Number of elements on this processor.">numOwnedNodes</a>*eq;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acb4ce84ddbfc7f9da09c9392556eb59f">00149</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acb4ce84ddbfc7f9da09c9392556eb59f">getOwnedDOF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> inode, <span class="keyword">const</span> <span class="keywordtype">int</span> eq)<span class="keyword"> const</span>
<a name="l00150"></a>00150 <span class="keyword">    </span>{
<a name="l00151"></a>00151       <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b85ad0bf31e97a6acfe3b9720a59a71">getDOF</a>(inode,eq);
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00154"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a95912447e6450aef241f8ce5d4b82fa0">00154</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a95912447e6450aef241f8ce5d4b82fa0">getOverlapDOF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> inode, <span class="keyword">const</span> <span class="keywordtype">int</span> eq)<span class="keyword"> const</span>
<a name="l00155"></a>00155 <span class="keyword">    </span>{
<a name="l00156"></a>00156       <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b85ad0bf31e97a6acfe3b9720a59a71">getDOF</a>(inode,eq);
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158 
<a name="l00159"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a4b6e80fbde371c26c601b8345a867337">00159</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a4b6e80fbde371c26c601b8345a867337">getGlobalDOF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> inode, <span class="keyword">const</span> <span class="keywordtype">int</span> eq)<span class="keyword"> const</span>
<a name="l00160"></a>00160 <span class="keyword">    </span>{
<a name="l00161"></a>00161       <span class="keywordflow">return</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b85ad0bf31e97a6acfe3b9720a59a71">getDOF</a>(inode,eq);
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="comment">// Copy field data from Epetra_Vector to APF</span>
<a name="l00165"></a>00165     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9ccc92aaa0f8bd72ad5bb04668de4ff5">setField</a>(
<a name="l00166"></a>00166         <span class="keyword">const</span> <span class="keywordtype">char</span>* name,
<a name="l00167"></a>00167         <span class="keyword">const</span> Epetra_Vector&amp; data,
<a name="l00168"></a>00168         <span class="keywordtype">bool</span> overlapped,
<a name="l00169"></a>00169         <span class="keywordtype">int</span> offset = 0);
<a name="l00170"></a>00170     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7fb8731d78d1fb45c0e7cd0631043bb5">setSplitFields</a>(std::vector&lt;std::string&gt; names, std::vector&lt;int&gt; indices, 
<a name="l00171"></a>00171         <span class="keyword">const</span> Epetra_Vector&amp; data, <span class="keywordtype">bool</span> overlapped);
<a name="l00172"></a>00172 
<a name="l00173"></a>00173     <span class="comment">// Copy field data from APF to Epetra_Vector</span>
<a name="l00174"></a>00174     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae2ee4820c70968857e6e34c06c725a1b">getField</a>(
<a name="l00175"></a>00175         <span class="keyword">const</span> <span class="keywordtype">char</span>* name,
<a name="l00176"></a>00176         Epetra_Vector&amp; data,
<a name="l00177"></a>00177         <span class="keywordtype">bool</span> overlapped,
<a name="l00178"></a>00178         <span class="keywordtype">int</span> offset = 0) <span class="keyword">const</span>;
<a name="l00179"></a>00179     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7f433e6c6822fabdf370c1ad1e69257f">getSplitFields</a>(std::vector&lt;std::string&gt; names, std::vector&lt;int&gt; indices,
<a name="l00180"></a>00180         Epetra_Vector&amp; data, <span class="keywordtype">bool</span> overlapped) <span class="keyword">const</span>;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     <span class="comment">// Rename exodus output file when the problem is resized</span>
<a name="l00183"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a75a4deacb4d4ebd2479fc254780be6ee">00183</a>     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a75a4deacb4d4ebd2479fc254780be6ee">reNameExodusOutput</a>(<span class="keyword">const</span> std::string&amp; str){ <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ac76cf75ed0c2b30055ba08198d51974c" title="Output object.">meshOutput</a>.setFileName(str);}
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="keyword">private</span>:
<a name="l00186"></a>00186 
<a name="l00188"></a>00188     <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6e2d452eaae6a32de58f876bacc0a4d6" title="Constructor.">FMDBDiscretization</a>(<span class="keyword">const</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html">FMDBDiscretization</a>&amp;);
<a name="l00189"></a>00189 
<a name="l00191"></a>00191     <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html">FMDBDiscretization</a>&amp; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9043e7c207a3ecea9ceee30debbf7a02" title="Private to prohibit copying.">operator=</a>(<span class="keyword">const</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html">FMDBDiscretization</a>&amp;);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <span class="comment">// Copy solution vector from Epetra_Vector into FMDB Mesh</span>
<a name="l00194"></a>00194     <span class="comment">// Here soln is the local (non overlapped) solution</span>
<a name="l00195"></a>00195     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a4ec6a7dfe8c5495d212d99c9b10b406e">setSolutionField</a>(<span class="keyword">const</span> Epetra_Vector&amp; soln);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acd61d39fb58cb34b3255480d0b66dcbf">nonzeroesPerRow</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3189db7ba940e93aa9643f8b8bae2fb5" title="Number of equations (and unknowns) per node.">neq</a>) <span class="keyword">const</span>;
<a name="l00198"></a>00198     <span class="keywordtype">double</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a2a6af66ff5a494175cf5fa3b020ad1c3">monotonicTimeLabel</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> time);
<a name="l00199"></a>00199 
<a name="l00201"></a>00201     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a24345f8118d9f5a9222d7c48e2d2c8e8" title="Process FMDB mesh for Owned nodal quantitites.">computeOwnedNodesAndUnknowns</a>();
<a name="l00203"></a>00203     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a4863da5ffb1b1026704b0c3df212dfa3" title="Process FMDB mesh for Overlap nodal quantitites.">computeOverlapNodesAndUnknowns</a>();
<a name="l00205"></a>00205     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa74e86321f0b669c9ecaf257fd1aac95" title="Process FMDB mesh for CRS Graphs.">computeGraphs</a>();
<a name="l00207"></a>00207     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a857a84ea17f388728198fe0e7fae487a" title="Process FMDB mesh for Workset/Bucket Info.">computeWorksetInfo</a>();
<a name="l00209"></a>00209     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a78891d77e44e2db4ab57b49fd5b06fff" title="Process FMDB mesh for NodeSets.">computeNodeSets</a>();
<a name="l00211"></a>00211     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a29d548c5632dddda51fbf71a4ce73007" title="Process FMDB mesh for SideSets.">computeSideSets</a>();
<a name="l00212"></a>00212 
<a name="l00214"></a>00214     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae9bc9e1c39ef7319ba742cbe8eb786a6" title="Transfer QPData to APF.">copyQPScalarToAPF</a>(<span class="keywordtype">unsigned</span> nqp, <a class="code" href="classAlbPUMI_1_1QPData.html">QPData&lt;double, 2&gt;</a>&amp; state, apf::Field* f);
<a name="l00215"></a>00215     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a789942fe8eb311264ad6f1e3f069d334">copyQPVectorToAPF</a>(<span class="keywordtype">unsigned</span> nqp, <a class="code" href="classAlbPUMI_1_1QPData.html">QPData&lt;double, 3&gt;</a>&amp; state, apf::Field* f);
<a name="l00216"></a>00216     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a9b5844c50fd7df0b29a19a14ac2cf365">copyQPTensorToAPF</a>(<span class="keywordtype">unsigned</span> nqp, <a class="code" href="classAlbPUMI_1_1QPData.html">QPData&lt;double, 4&gt;</a>&amp; state, apf::Field* f);
<a name="l00217"></a>00217     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a8c7b0c43a3f10d74a0955d78a0a98139">copyQPStatesToAPF</a>();
<a name="l00218"></a>00218     <span class="keywordtype">void</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a72a4d089f56d7ca623120af0c2e7314c">removeQPStatesFromAPF</a>();
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <span class="comment">// ! Split Solution fields</span>
<a name="l00221"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aafade44467a1972f674e69d4053cbc8c">00221</a>     std::vector&lt;std::string&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aafade44467a1972f674e69d4053cbc8c">solNames</a>;
<a name="l00222"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a05c67b9d62ec1450ddaaf1098bb9989f">00222</a>     std::vector&lt;std::string&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a05c67b9d62ec1450ddaaf1098bb9989f">resNames</a>;
<a name="l00223"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa16f3ea135c51f848d7b5817df0bd7a1">00223</a>     std::vector&lt;int&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa16f3ea135c51f848d7b5817df0bd7a1">solIndex</a>;
<a name="l00224"></a>00224 
<a name="l00226"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a82acec84364ef37709fcbee2326c1cb7">00226</a>     Teuchos::RCP&lt;Teuchos::FancyOStream&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a82acec84364ef37709fcbee2326c1cb7" title="Call stk_io for creating exodus output file.">out</a>;
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a130520c3a0be4c685989282966f830d7">00228</a>     <span class="keywordtype">double</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a130520c3a0be4c685989282966f830d7">previous_time_label</a>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="comment">// Transformation types for FELIX problems</span>
<a name="l00231"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa60a7f5e2ec0e98555a2dc3f170c4f43">00231</a>     <span class="keyword">enum</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa60a7f5e2ec0e98555a2dc3f170c4f43">TRANSFORMTYPE</a> {NONE, <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa60a7f5e2ec0e98555a2dc3f170c4f43a76da8e8f791e1ab3c237bde8e5186c9d">ISMIP_HOM_TEST_A</a>};
<a name="l00232"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a2563655869bca33c3cab7f5ed75b80eb">00232</a>     <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa60a7f5e2ec0e98555a2dc3f170c4f43">TRANSFORMTYPE</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a2563655869bca33c3cab7f5ed75b80eb">transform_type</a>;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keyword">protected</span>:
<a name="l00235"></a>00235 
<a name="l00237"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ac76cf75ed0c2b30055ba08198d51974c">00237</a>     Output <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ac76cf75ed0c2b30055ba08198d51974c" title="Output object.">meshOutput</a>;
<a name="l00238"></a>00238 
<a name="l00240"></a>00240 
<a name="l00242"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7d1190558a94ea348521bd01bbdfd2d7">00242</a>     Teuchos::RCP&lt;const Epetra_Comm&gt; comm;
<a name="l00243"></a>00243 
<a name="l00245"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ab8d6c20156402e12d1406136cd409db0">00245</a>     Teuchos::RCP&lt;Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ab8d6c20156402e12d1406136cd409db0" title="Node map.">node_map</a>;
<a name="l00246"></a>00246 
<a name="l00248"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad324c117e9184285851313cf597b0b61">00248</a>     Teuchos::RCP&lt;Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad324c117e9184285851313cf597b0b61" title="Unknown Map.">map</a>;
<a name="l00249"></a>00249 
<a name="l00251"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a519e43ce03e84dd4523bb926b430da70">00251</a>     Teuchos::RCP&lt;Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a519e43ce03e84dd4523bb926b430da70" title="Overlapped unknown map, and node map.">overlap_map</a>;
<a name="l00252"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acad8cd7a63d6454e6dbb693a441433a5">00252</a>     Teuchos::RCP&lt;Epetra_Map&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acad8cd7a63d6454e6dbb693a441433a5">overlap_node_map</a>;
<a name="l00253"></a>00253 
<a name="l00255"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a687f7b0c2eaae12f67be20e56789699e">00255</a>     Teuchos::RCP&lt;Epetra_CrsGraph&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a687f7b0c2eaae12f67be20e56789699e" title="Jacobian matrix graph.">graph</a>;
<a name="l00256"></a>00256 
<a name="l00258"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ace5cff8437b7947e42a96e7fc40f0c63">00258</a>     Teuchos::RCP&lt;Epetra_CrsGraph&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ace5cff8437b7947e42a96e7fc40f0c63" title="Overlapped Jacobian matrix graph.">overlap_graph</a>;
<a name="l00259"></a>00259 
<a name="l00261"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3189db7ba940e93aa9643f8b8bae2fb5">00261</a>     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3189db7ba940e93aa9643f8b8bae2fb5" title="Number of equations (and unknowns) per node.">neq</a>;
<a name="l00262"></a>00262 
<a name="l00264"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aeaa47b390cd04fd65f6812859cb04a28">00264</a>     <a class="code" href="namespaceAlbany.html#ac6fb9ef9b5bb66848b3ed2926c552894">Albany::NodeSetList</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aeaa47b390cd04fd65f6812859cb04a28" title="node sets stored as std::map(string ID, int vector of GIDs)">nodeSets</a>;
<a name="l00265"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a085368c8fc8322335def4cec0330ecb4">00265</a>     <a class="code" href="namespaceAlbany.html#ad41143a14c776475291e32beedece98a">Albany::NodeSetCoordList</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a085368c8fc8322335def4cec0330ecb4">nodeSetCoords</a>;
<a name="l00266"></a>00266 
<a name="l00268"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7f3cbd9ccf42c181731d304cc46ee9ff">00268</a>     std::vector&lt;Albany::SideSetList&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7f3cbd9ccf42c181731d304cc46ee9ff" title="side sets stored as std::map(string ID, SideArray classes) per workset (std::vector across worksets)...">sideSets</a>;
<a name="l00269"></a>00269 
<a name="l00271"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ab45bb22b3c3ee71ee40d7c3513282be9">00271</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;int&gt;</a> &gt; &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ab45bb22b3c3ee71ee40d7c3513282be9" title="Connectivity array [workset, element, local-node, Eq] =&amp;gt; LID.">wsElNodeEqID</a>;
<a name="l00272"></a>00272 
<a name="l00273"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa50970dea5d6d5faaf83f95fe35e6343">00273</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;int&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa50970dea5d6d5faaf83f95fe35e6343">wsElNodeID</a>;
<a name="l00274"></a>00274 
<a name="l00275"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af463aaa757ceae108471aca50161e383">00275</a>     <span class="keyword">mutable</span> Teuchos::ArrayRCP&lt;double&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af463aaa757ceae108471aca50161e383">coordinates</a>;
<a name="l00276"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a783794e3b9848c1501f488829a520c52">00276</a>     <a class="code" href="structAlbany_1_1WorksetArray.html#a2251678748f133c70ad2b97345319967">Albany::WorksetArray&lt;std::string&gt;::type</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a783794e3b9848c1501f488829a520c52">wsEBNames</a>;
<a name="l00277"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#afa68b6d861e5a6a6f09c5d6f65c59490">00277</a>     <a class="code" href="structAlbany_1_1WorksetArray.html#a2251678748f133c70ad2b97345319967">Albany::WorksetArray&lt;int&gt;::type</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#afa68b6d861e5a6a6f09c5d6f65c59490">wsPhysIndex</a>;
<a name="l00278"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a458ba67499378c33ab3172419609892b">00278</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a458ba67499378c33ab3172419609892b">coords</a>;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     <span class="comment">// FELIX unused variables (FIXME)</span>
<a name="l00281"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7c03e5aa1d7e27ad0902f785bb14f781">00281</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7c03e5aa1d7e27ad0902f785bb14f781">sHeight</a>;
<a name="l00282"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a55b4daae2788b23a834312970eedd794">00282</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a55b4daae2788b23a834312970eedd794">temperature</a>;
<a name="l00283"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad6ceffb80711f170d76f469f505388e4">00283</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad6ceffb80711f170d76f469f505388e4">basalFriction</a>;
<a name="l00284"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5d6c36973fba3c74ed6a0832314feda1">00284</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5d6c36973fba3c74ed6a0832314feda1">thickness</a>;
<a name="l00285"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aaf2c5762fca7d877f525f4ab7cdeb176">00285</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aaf2c5762fca7d877f525f4ab7cdeb176">surfaceVelocity</a>;
<a name="l00286"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae1ff3ab84fb971b3632044c1e3d0d598">00286</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;Teuchos::ArrayRCP&lt;double*&gt;</a> &gt; &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ae1ff3ab84fb971b3632044c1e3d0d598">velocityRMS</a>;
<a name="l00287"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b22c768b879cd2730d8a60df90b1a08">00287</a>     <a class="code" href="structAlbany_1_1WorksetArray.html">Albany::WorksetArray&lt;Teuchos::ArrayRCP&lt;double&gt;</a> &gt;::type <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a3b22c768b879cd2730d8a60df90b1a08">flowFactor</a>;
<a name="l00288"></a>00288 
<a name="l00290"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a958245b7cbcec18441b5187f75eb40d2">00290</a>     <a class="code" href="namespaceAlbany.html#af11daa75105be6e470b4271a6a7295cb">Albany::WsLIDList</a>  <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a958245b7cbcec18441b5187f75eb40d2" title="Connectivity map from elementGID to workset and LID in workset.">elemGIDws</a>;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292     <span class="comment">// States: vector of length num worksets of a map from field name to shards array</span>
<a name="l00293"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a61b42aea7b0fbd9cdba6f73c02de5c55">00293</a>     <a class="code" href="structAlbany_1_1StateArrays.html">Albany::StateArrays</a> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a61b42aea7b0fbd9cdba6f73c02de5c55">stateArrays</a>;
<a name="l00294"></a>00294 
<a name="l00296"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aad11108cbc0ab01e0085eee0c8c6de9b">00296</a>     apf::DynamicArray&lt;apf::Node&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aad11108cbc0ab01e0085eee0c8c6de9b" title="list of all overlap nodes, saved for setting solution">nodes</a>;
<a name="l00297"></a>00297 
<a name="l00299"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a8dc79e9eaa2504fb986595892bab3013">00299</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a8dc79e9eaa2504fb986595892bab3013" title="Number of elements on this processor.">numOwnedNodes</a>;
<a name="l00300"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a24a42901f684d82939664ccb4755b51a">00300</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a24a42901f684d82939664ccb4755b51a">numOverlapNodes</a>;
<a name="l00301"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6bde374c73a78f907d6fdf40e03548bf">00301</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6bde374c73a78f907d6fdf40e03548bf">numGlobalNodes</a>;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="comment">// Coordinate vector in format needed by ML. Need to own memory here.</span>
<a name="l00304"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a86b9e8dd733a65c2f0cbc243410c9018">00304</a>     <span class="keywordtype">double</span> *<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#abbc1ecc2070c1778f60780a9ca8987f6">xx</a>, *<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ac61443291651151167ca5bd0937993b1">yy</a>, *<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a86b9e8dd733a65c2f0cbc243410c9018">zz</a>, *<a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#af5c652a3fe6e8bc0b6d7d4e9aadc2f5e">rr</a>;
<a name="l00305"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa7706aa79be5e9c905c67b4c74c84d64">00305</a>     <span class="keywordtype">bool</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#aa7706aa79be5e9c905c67b4c74c84d64">allocated_xyz</a>;
<a name="l00306"></a>00306 
<a name="l00307"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5376a1c1a1d5e981aa4c945736f02090">00307</a>     Teuchos::RCP&lt;AlbPUMI::FMDBMeshStruct&gt; fmdbMeshStruct;
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7ffb0250fce2e3b0eeebf79796007999">00309</a>     <span class="keywordtype">bool</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a7ffb0250fce2e3b0eeebf79796007999">interleavedOrdering</a>;
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad8c395f1702c168a101a750414d0db27">00311</a>     std::vector&lt; std::vector&lt;apf::MeshEntity*&gt; &gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#ad8c395f1702c168a101a750414d0db27">buckets</a>; <span class="comment">// bucket of elements</span>
<a name="l00312"></a>00312 
<a name="l00313"></a>00313     <span class="comment">// storage to save the node coordinates of the nodesets visible to this PE</span>
<a name="l00314"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5ba22d206757ad29fedfb8be7aabbf90">00314</a>     std::map&lt;std::string, std::vector&lt;double&gt; &gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a5ba22d206757ad29fedfb8be7aabbf90">nodeset_node_coords</a>;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="comment">// Needed to pass coordinates to ML. </span>
<a name="l00317"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acbd6df4cf191aee3e9c940da41e0aaa5">00317</a>     Teuchos::RCP&lt;Piro::MLRigidBodyModes&gt; <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#acbd6df4cf191aee3e9c940da41e0aaa5">rigidBodyModes</a>;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="comment">// counter for limiting data writes to output file</span>
<a name="l00320"></a><a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6a4e7ecd7b1066a40605885af696b698">00320</a>     <span class="keywordtype">int</span> <a class="code" href="classAlbPUMI_1_1FMDBDiscretization.html#a6a4e7ecd7b1066a40605885af696b698">outputInterval</a>;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   };
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <span class="comment">// Define macro for explicit template instantiation</span>
<a name="l00327"></a><a class="code" href="AlbPUMI__FMDBDiscretization_8hpp.html#a1463e6649386495772241602e4abf599">00327</a> <span class="preprocessor">#define FMDB_INSTANTIATE_TEMPLATE_CLASS_VTK(name) \</span>
<a name="l00328"></a>00328 <span class="preprocessor">  template class name&lt;AlbPUMI::FMDBVtk&gt;;</span>
<a name="l00329"></a><a class="code" href="AlbPUMI__FMDBDiscretization_8hpp.html#a0e2fc2d96f638a43fe4c6ca3126534f1">00329</a> <span class="preprocessor"></span><span class="preprocessor">#define FMDB_INSTANTIATE_TEMPLATE_CLASS_EXODUS(name) \</span>
<a name="l00330"></a>00330 <span class="preprocessor">  template class name&lt;AlbPUMI::FMDBExodus&gt;;</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>
<a name="l00332"></a><a class="code" href="AlbPUMI__FMDBDiscretization_8hpp.html#ae8bee6a53dbdd6e53dd1b07ee87eae5d">00332</a> <span class="preprocessor">#define FMDB_INSTANTIATE_TEMPLATE_CLASS(name) \</span>
<a name="l00333"></a>00333 <span class="preprocessor">  FMDB_INSTANTIATE_TEMPLATE_CLASS_VTK(name) \</span>
<a name="l00334"></a>00334 <span class="preprocessor">  FMDB_INSTANTIATE_TEMPLATE_CLASS_EXODUS(name)</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>
<a name="l00336"></a>00336 <span class="preprocessor">#endif // ALBANY_FMDBDISCRETIZATION_HPP</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 26 2014 18:36:37 for Albany: a Trilinos-based PDE code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
