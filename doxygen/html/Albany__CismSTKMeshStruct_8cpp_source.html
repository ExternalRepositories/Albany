<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Albany: a Trilinos-based PDE code: Albany_CismSTKMeshStruct.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Albany_CismSTKMeshStruct.cpp</h1>  </div>
</div>
<div class="contents">
<a href="Albany__CismSTKMeshStruct_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************//</span>
<a name="l00002"></a>00002 <span class="comment">//    Albany 2.0:  Copyright 2012 Sandia Corporation               //</span>
<a name="l00003"></a>00003 <span class="comment">//    This Software is released under the BSD license detailed     //</span>
<a name="l00004"></a>00004 <span class="comment">//    in the file &quot;license.txt&quot; in the top-level Albany directory  //</span>
<a name="l00005"></a>00005 <span class="comment">//*****************************************************************//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="Albany__CismSTKMeshStruct_8hpp.html">Albany_CismSTKMeshStruct.hpp</a>&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;Teuchos_VerboseObject.hpp&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;Shards_BasicTopologies.hpp&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;stk_mesh/base/Entity.hpp&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;stk_mesh/base/GetEntities.hpp&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stk_mesh/base/GetBuckets.hpp&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;stk_mesh/base/FieldData.hpp&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;stk_mesh/base/Selector.hpp&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stk_io/IossBridge.hpp&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#endif</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="comment">//#include &lt;stk_mesh/fem/FEMHelpers.hpp&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;boost/algorithm/string/predicate.hpp&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="Albany__Utils_8hpp.html">Albany_Utils.hpp</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">//Constructor for arrays passed from CISM through Albany-CISM interface</span>
<a name="l00031"></a><a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a2816cd5ca1425230a922a1f75a8642d8">00031</a> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a2816cd5ca1425230a922a1f75a8642d8">Albany::CismSTKMeshStruct::CismSTKMeshStruct</a>(
<a name="l00032"></a>00032                   <span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; params, 
<a name="l00033"></a>00033                   <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>, 
<a name="l00034"></a>00034                   <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="felix__driver_8cpp.html#af62380358bbc17081a691d49d86005d4">xyz_at_nodes_Ptr</a>, 
<a name="l00035"></a>00035                   <span class="keyword">const</span> <span class="keywordtype">int</span> * <a class="code" href="felix__driver_8cpp.html#a82efeaf71a4f15b46f17749f6cc76206">global_node_id_owned_map_Ptr</a>, 
<a name="l00036"></a>00036                   <span class="keyword">const</span> <span class="keywordtype">int</span> * <a class="code" href="felix__driver_8cpp.html#ab9f22496d26d21aae9ba0c06e406660c">global_element_id_active_owned_map_Ptr</a>, 
<a name="l00037"></a>00037                   <span class="keyword">const</span> <span class="keywordtype">int</span> * <a class="code" href="felix__driver_8cpp.html#a0dcbe6fa72ab0fd4fc399e679112f4c7">global_element_conn_active_Ptr</a>, 
<a name="l00038"></a>00038                   <span class="keyword">const</span> <span class="keywordtype">int</span> *global_basal_face_active_owned_map_Ptr, 
<a name="l00039"></a>00039                   <span class="keyword">const</span> <span class="keywordtype">int</span> * <a class="code" href="felix__driver_8cpp.html#af94320f5df9a5923e219d70db3b0a438">global_basal_face_conn_active_Ptr</a>, 
<a name="l00040"></a>00040                   <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="felix__driver_8cpp.html#a93a4ecba1916b1bc3ec66bdecab75044">beta_at_nodes_Ptr</a>, 
<a name="l00041"></a>00041                   <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="felix__driver_8cpp.html#a912ab5f799265bddff9a30ce4b4699b6">surf_height_at_nodes_Ptr</a>, 
<a name="l00042"></a>00042                   <span class="keyword">const</span> <span class="keywordtype">double</span> * <a class="code" href="felix__driver_8cpp.html#a7aec45ea844c90fcb7d0027297e7c6cb">flwa_at_active_elements_Ptr</a>,
<a name="l00043"></a>00043                   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="felix__driver_8cpp.html#ab5242add5962116d4d46270da25895b3">nNodes</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="felix__driver_8cpp.html#aed1db7de491b9311aad60370dc10a170">nElementsActive</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="felix__driver_8cpp.html#a74fc3f0a9d140b6b442f4976f0a2cb32">nCellsActive</a>) : 
<a name="l00044"></a>00044   <a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html">GenericSTKMeshStruct</a>(params,Teuchos::null,3),
<a name="l00045"></a>00045   out(Teuchos::VerboseObjectBase::getDefaultOStream()),
<a name="l00046"></a>00046   hasRestartSol(false), 
<a name="l00047"></a>00047   restartTime(0.0), 
<a name="l00048"></a>00048   periodic(false)
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050   <span class="keywordflow">if</span> (comm-&gt;MyPID() == 0) std::cout &lt;&lt;<span class="stringliteral">&quot;In Albany::CismSTKMeshStruct - double * array inputs!&quot;</span> &lt;&lt; std::endl; 
<a name="l00051"></a>00051   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a> = nNodes;  
<a name="l00052"></a>00052   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a> = nElementsActive; 
<a name="l00053"></a>00053   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a> = nCellsActive; 
<a name="l00054"></a>00054   std::cout &lt;&lt;<span class="stringliteral">&quot;NumNodes = &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a> &lt;&lt; <span class="stringliteral">&quot;, NumEles = &quot;</span>&lt;&lt; <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a> &lt;&lt; <span class="stringliteral">&quot;, NumBasalFaces = &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a> &lt;&lt; std::endl; 
<a name="l00055"></a>00055   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a>][3]; 
<a name="l00056"></a>00056   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a>][8]; 
<a name="l00057"></a>00057   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a>][5]; <span class="comment">//1st column of bf: element # that face belongs to, 2rd-5th columns of bf: connectivity (hard-coded for quad faces) </span>
<a name="l00058"></a>00058   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a>]; 
<a name="l00059"></a>00059   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa5703f6b8c6643a3e0412dac180fc3d9">globalNodesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a>];
<a name="l00060"></a>00060   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ad3e91e01f95240e383ea4caba7994bf5">globalElesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a>];
<a name="l00061"></a>00061   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a871aacddb83c888064108a13840d158e">basalFacesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a>];
<a name="l00062"></a>00062   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a739705c1f7d256f5255fc3e9a722d351">flwa</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a>]; 
<a name="l00063"></a>00063   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a>]; 
<a name="l00064"></a>00064   <span class="comment">//TO DO? pass in temper?  for now, flwa is passed instead of temper</span>
<a name="l00065"></a>00065   <span class="comment">//temper = new double[NumEles]; </span>
<a name="l00066"></a>00066   
<a name="l00067"></a>00067   <span class="comment">//check if optional input fields exist</span>
<a name="l00068"></a>00068   <span class="keywordflow">if</span> (surf_height_at_nodes_Ptr != NULL) <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a> = <span class="keyword">true</span>;
<a name="l00069"></a>00069   <span class="keywordflow">else</span> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a> = <span class="keyword">false</span>;  
<a name="l00070"></a>00070   <span class="keywordflow">if</span> (global_basal_face_active_owned_map_Ptr != NULL) <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a> = <span class="keyword">true</span>; 
<a name="l00071"></a>00071   <span class="keywordflow">else</span> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a> = <span class="keyword">false</span>; 
<a name="l00072"></a>00072   <span class="keywordflow">if</span> (flwa_at_active_elements_Ptr != NULL) <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1f151457ea80b9049855fd436c8ebc95">have_flwa</a> = <span class="keyword">true</span>; 
<a name="l00073"></a>00073   <span class="keywordflow">else</span> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1f151457ea80b9049855fd436c8ebc95">have_flwa</a> = <span class="keyword">false</span>; 
<a name="l00074"></a>00074   <span class="keywordflow">if</span> (beta_at_nodes_Ptr != NULL) <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#afcff7d985fbf9249972ef955f71b2fae">have_beta</a> = <span class="keyword">true</span>; 
<a name="l00075"></a>00075   <span class="keywordflow">else</span> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#afcff7d985fbf9249972ef955f71b2fae">have_beta</a> = <span class="keyword">false</span>; 
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a0e9310bc6e86f6e3781cb1a299eddc90">have_temp</a> = <span class="keyword">false</span>; <span class="comment">//for now temperature field is not passed; flwa is passed instead</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aef9833b3143396498b12074e03995353">NumNodes</a>; i++){
<a name="l00080"></a>00080     <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa5703f6b8c6643a3e0412dac180fc3d9">globalNodesID</a>[i] = global_node_id_owned_map_Ptr[i]-1;  
<a name="l00081"></a>00081     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) 
<a name="l00082"></a>00082       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[i][j] = xyz_at_nodes_Ptr[i + NumNodes*j]; 
<a name="l00083"></a>00083     <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, x: &quot; &lt;&lt; xyz[i][0] &lt;&lt; &quot;, y: &quot; &lt;&lt; xyz[i][1] &lt;&lt; &quot;, z: &quot; &lt;&lt; xyz[i][2] &lt;&lt; std::endl; </span>
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a>) {
<a name="l00086"></a>00086     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++) 
<a name="l00087"></a>00087       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[i] = surf_height_at_nodes_Ptr[i]; 
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#afcff7d985fbf9249972ef955f71b2fae">have_beta</a>) {
<a name="l00090"></a>00090     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++)
<a name="l00091"></a>00091       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[i] = beta_at_nodes_Ptr[i]; 
<a name="l00092"></a>00092   }
<a name="l00093"></a>00093  
<a name="l00094"></a>00094   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa80009b4b9fe3ee89148099406244d2b">NumEles</a>; i++) { 
<a name="l00095"></a>00095     <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ad3e91e01f95240e383ea4caba7994bf5">globalElesID</a>[i] = global_element_id_active_owned_map_Ptr[i]-1; 
<a name="l00096"></a>00096     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt;8; j++)
<a name="l00097"></a>00097       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][j] = global_element_conn_active_Ptr[i + nElementsActive*j];
<a name="l00098"></a>00098     <span class="comment">//*out &lt;&lt; &quot;elt # &quot; &lt;&lt; globalElesID[i] &lt;&lt; &quot;: &quot; &lt;&lt; eles[i][0] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][1] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][2] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][3] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][4] &lt;&lt; &quot; &quot;</span>
<a name="l00099"></a>00099     <span class="comment">//                      &lt;&lt; eles[i][5] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][6] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][7] &lt;&lt; std::endl; </span>
<a name="l00100"></a>00100   }
<a name="l00101"></a>00101   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1f151457ea80b9049855fd436c8ebc95">have_flwa</a>) { 
<a name="l00102"></a>00102     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumEles; i++)  
<a name="l00103"></a>00103       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a739705c1f7d256f5255fc3e9a722d351">flwa</a>[i] = flwa_at_active_elements_Ptr[i]; 
<a name="l00104"></a>00104   }
<a name="l00105"></a>00105   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a>) { 
<a name="l00106"></a>00106     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a>; i++) {
<a name="l00107"></a>00107       <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a871aacddb83c888064108a13840d158e">basalFacesID</a>[i] = global_basal_face_active_owned_map_Ptr[i]-1; 
<a name="l00108"></a>00108       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;5; j++) 
<a name="l00109"></a>00109         <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][j] = global_basal_face_conn_active_Ptr[i + nCellsActive*j]; 
<a name="l00110"></a>00110       <span class="comment">//*out &lt;&lt; &quot;bf # &quot; &lt;&lt; basalFacesID[i] &lt;&lt; &quot;: &quot; &lt;&lt; bf[i][0] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][1] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][2] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][3] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][4] &lt;&lt; std::endl; </span>
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113  
<a name="l00114"></a>00114   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aaf55e4f8b4b8d7014eda709437123d94">elem_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, NumEles, <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ad3e91e01f95240e383ea4caba7994bf5">globalElesID</a>, 0, *comm)); <span class="comment">//Distribute the elements according to the global element IDs</span>
<a name="l00115"></a>00115   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, NumNodes, <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa5703f6b8c6643a3e0412dac180fc3d9">globalNodesID</a>, 0, *comm)); <span class="comment">//Distribute the nodes according to the global node IDs </span>
<a name="l00116"></a>00116   <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ab6ad846611268075fa645a46a514910f">basal_face_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aab9ced0bf8574de7753f746098bc56b0">NumBasalFaces</a>, <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a871aacddb83c888064108a13840d158e">basalFacesID</a>, 0, *comm)); <span class="comment">//Distribute the elements according to the basal face IDs</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   
<a name="l00119"></a>00119   params-&gt;validateParameters(*<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a228d7f5d6f70048a8bbcf497073685d6">getValidDiscretizationParameters</a>(),0);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   std::string ebn=<span class="stringliteral">&quot;Element Block 0&quot;</span>;
<a name="l00123"></a>00123   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(ebn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank() );
<a name="l00124"></a>00124   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a1fe4dbe7e44920f111a80ffd008f1e37">ebNameToIndex</a>[ebn] = 0;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>  stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]);
<a name="l00128"></a>00128 <span class="preprocessor">#endif</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   std::vector&lt;std::string&gt; nsNames;
<a name="l00132"></a>00132   std::string <a class="code" href="felix__driver_8cpp.html#ab535ad6429f94303bc2e0347bb388e0d">nsn</a>=<span class="stringliteral">&quot;Bottom&quot;</span>;
<a name="l00133"></a>00133   nsNames.push_back(nsn);
<a name="l00134"></a>00134   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00135"></a>00135 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00137"></a>00137 <span class="preprocessor">#endif</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet0&quot;</span>;
<a name="l00139"></a>00139   nsNames.push_back(nsn);
<a name="l00140"></a>00140   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00141"></a>00141 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00142"></a>00142 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00143"></a>00143 <span class="preprocessor">#endif</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet1&quot;</span>;
<a name="l00145"></a>00145   nsNames.push_back(nsn);
<a name="l00146"></a>00146   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00147"></a>00147 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00148"></a>00148 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00149"></a>00149 <span class="preprocessor">#endif</span>
<a name="l00150"></a>00150 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet2&quot;</span>;
<a name="l00151"></a>00151   nsNames.push_back(nsn);
<a name="l00152"></a>00152   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00153"></a>00153 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00155"></a>00155 <span class="preprocessor">#endif</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet3&quot;</span>;
<a name="l00157"></a>00157   nsNames.push_back(nsn);
<a name="l00158"></a>00158   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00159"></a>00159 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00161"></a>00161 <span class="preprocessor">#endif</span>
<a name="l00162"></a>00162 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet4&quot;</span>;
<a name="l00163"></a>00163   nsNames.push_back(nsn);
<a name="l00164"></a>00164   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00165"></a>00165 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00166"></a>00166 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00167"></a>00167 <span class="preprocessor">#endif</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet5&quot;</span>;
<a name="l00169"></a>00169   nsNames.push_back(nsn);
<a name="l00170"></a>00170   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00171"></a>00171 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00173"></a>00173 <span class="preprocessor">#endif</span>
<a name="l00174"></a>00174 <span class="preprocessor"></span>
<a name="l00175"></a>00175 
<a name="l00176"></a>00176   std::vector&lt;std::string&gt; ssNames;
<a name="l00177"></a>00177   std::string ssn=<span class="stringliteral">&quot;Basal&quot;</span>;
<a name="l00178"></a>00178   ssNames.push_back(ssn);
<a name="l00179"></a>00179     <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(ssn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank() );
<a name="l00180"></a>00180 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn]);
<a name="l00182"></a>00182 <span class="preprocessor">#endif</span>
<a name="l00183"></a>00183 <span class="preprocessor"></span>
<a name="l00184"></a>00184   stk::mesh::fem::set_cell_topology&lt;shards::Hexahedron&lt;8&gt; &gt;(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]);
<a name="l00185"></a>00185   stk::mesh::fem::set_cell_topology&lt;shards::Quadrilateral&lt;4&gt; &gt;(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn]);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a302b929f043c676f028876f393978787">numDim</a> = 3;
<a name="l00188"></a>00188   <span class="keywordtype">int</span> cub = params-&gt;get(<span class="stringliteral">&quot;Cubature Degree&quot;</span>,3);
<a name="l00189"></a>00189   <span class="keywordtype">int</span> worksetSizeMax = params-&gt;get(<span class="stringliteral">&quot;Workset Size&quot;</span>,50);
<a name="l00190"></a>00190   <span class="keywordtype">int</span> worksetSize = this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#a65a072dfa4df218a71f3ea0f88b6fdd2" title="Utility function that uses some integer arithmetic to choose a good worksetSize.">computeWorksetSize</a>(worksetSizeMax, <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aaf55e4f8b4b8d7014eda709437123d94">elem_map</a>-&gt;NumMyElements());
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="keyword">const</span> CellTopologyData&amp; ctd = *<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;get_cell_topology(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]).getCellTopologyData();
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#aa5b51847bf2f760e188e953d00d250e9">meshSpecs</a>[0] = Teuchos::rcp(<span class="keyword">new</span> <a class="code" href="structAlbany_1_1MeshSpecsStruct.html">Albany::MeshSpecsStruct</a>(ctd, numDim, cub,
<a name="l00195"></a>00195                              nsNames, ssNames, worksetSize, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]-&gt;name(),
<a name="l00196"></a>00196                              <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a1fe4dbe7e44920f111a80ffd008f1e37">ebNameToIndex</a>, this-&gt;<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a69d84e0494e6ab2a2c78201c8d5224fa">interleavedOrdering</a>));
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a><a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1cba6d6e92b43bddf30c7c460667fb57">00201</a> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1cba6d6e92b43bddf30c7c460667fb57">Albany::CismSTKMeshStruct::~CismSTKMeshStruct</a>()
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>; 
<a name="l00204"></a>00204   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a>) <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>; 
<a name="l00205"></a>00205   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a>) <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>; 
<a name="l00206"></a>00206   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>; 
<a name="l00207"></a>00207   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ad3e91e01f95240e383ea4caba7994bf5">globalElesID</a>; 
<a name="l00208"></a>00208   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa5703f6b8c6643a3e0412dac180fc3d9">globalNodesID</a>;
<a name="l00209"></a>00209   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a871aacddb83c888064108a13840d158e">basalFacesID</a>; 
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="keywordtype">void</span>
<a name="l00213"></a><a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a636281e4ac9d51d617aa78311c11c4f9">00213</a> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a636281e4ac9d51d617aa78311c11c4f9">Albany::CismSTKMeshStruct::constructMesh</a>(
<a name="l00214"></a>00214                                                <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>,
<a name="l00215"></a>00215                                                <span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; params,
<a name="l00216"></a>00216                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neq_,
<a name="l00217"></a>00217                                                <span class="keyword">const</span> <a class="code" href="classAlbany_1_1AbstractFieldContainer.html#a2bfe39ada257455a2bbe082a0b743704">AbstractFieldContainer::FieldContainerRequirements</a>&amp; req,
<a name="l00218"></a>00218                                                <span class="keyword">const</span> Teuchos::RCP&lt;Albany::StateInfoStruct&gt;&amp; <a class="code" href="InterfaceTry_8cpp.html#a22a797db574d6de7b11c63d19b59ce22">sis</a>,
<a name="l00219"></a>00219                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> worksetSize)
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221   this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#ae82d1109009b447cbc774991cd23d8dd">SetupFieldData</a>(comm, neq_, req, sis, worksetSize);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;commit();
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;modification_begin(); <span class="comment">// Begin modifying the mesh</span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   stk::mesh::PartVector nodePartVec;
<a name="l00228"></a>00228   stk::mesh::PartVector singlePartVec(1);
<a name="l00229"></a>00229   stk::mesh::PartVector emptyPartVec;
<a name="l00230"></a>00230   std::cout &lt;&lt; <span class="stringliteral">&quot;elem_map # elements: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aaf55e4f8b4b8d7014eda709437123d94">elem_map</a>-&gt;NumMyElements() &lt;&lt; std::endl; 
<a name="l00231"></a>00231   std::cout &lt;&lt; <span class="stringliteral">&quot;node_map # elements: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;NumMyElements() &lt;&lt; std::endl; 
<a name="l00232"></a>00232   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ebNo = 0; <span class="comment">//element block #??? </span>
<a name="l00233"></a>00233   <span class="keywordtype">int</span> sideID = 0;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#ab29b7b67367d394e0364838c6e3fcf73">AbstractSTKFieldContainer::VectorFieldType</a>* coordinates_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getCoordinatesField();
<a name="l00236"></a>00236   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* surfaceHeight_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getSurfaceHeightField();
<a name="l00237"></a>00237   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* flowFactor_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getFlowFactorField();
<a name="l00238"></a>00238   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* temperature_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getTemperatureField();
<a name="l00239"></a>00239   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* basal_friction_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getBasalFrictionField();
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="keywordflow">if</span>(!surfaceHeight_field) 
<a name="l00242"></a>00242      <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a> = <span class="keyword">false</span>;
<a name="l00243"></a>00243   <span class="keywordflow">if</span>(!flowFactor_field) 
<a name="l00244"></a>00244      <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1f151457ea80b9049855fd436c8ebc95">have_flwa</a> = <span class="keyword">false</span>;
<a name="l00245"></a>00245   <span class="keywordflow">if</span>(!temperature_field) 
<a name="l00246"></a>00246      <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a0e9310bc6e86f6e3781cb1a299eddc90">have_temp</a> = <span class="keyword">false</span>;
<a name="l00247"></a>00247   <span class="keywordflow">if</span>(!basal_friction_field) 
<a name="l00248"></a>00248      <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#afcff7d985fbf9249972ef955f71b2fae">have_beta</a> = <span class="keyword">false</span>;
<a name="l00249"></a>00249 
<a name="l00250"></a>00250   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aaf55e4f8b4b8d7014eda709437123d94">elem_map</a>-&gt;NumMyElements(); i++) {
<a name="l00251"></a>00251      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aaf55e4f8b4b8d7014eda709437123d94">elem_map</a>-&gt;GID(i);
<a name="l00252"></a>00252      stk::mesh::EntityId elem_id = (stk::mesh::EntityId) elem_GID;
<a name="l00253"></a>00253      singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[ebNo];
<a name="l00254"></a>00254      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; elem  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank(), 1+elem_id, singlePartVec);
<a name="l00255"></a>00255      <span class="comment">//I am assuming the ASCII mesh is 1-based not 0-based, so no need to add 1 for STK mesh </span>
<a name="l00256"></a>00256      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][0], nodePartVec);
<a name="l00257"></a>00257      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][1], nodePartVec);
<a name="l00258"></a>00258      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][2], nodePartVec);
<a name="l00259"></a>00259      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][3], nodePartVec);
<a name="l00260"></a>00260      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][4], nodePartVec);
<a name="l00261"></a>00261      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][5], nodePartVec);
<a name="l00262"></a>00262      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][6], nodePartVec);
<a name="l00263"></a>00263      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][7], nodePartVec);
<a name="l00264"></a>00264      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, llnode, 0);
<a name="l00265"></a>00265      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, lrnode, 1);
<a name="l00266"></a>00266      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, urnode, 2);
<a name="l00267"></a>00267      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, ulnode, 3);
<a name="l00268"></a>00268      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, llnodeb, 4);
<a name="l00269"></a>00269      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, lrnodeb, 5);
<a name="l00270"></a>00270      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, urnodeb, 6);
<a name="l00271"></a>00271      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, ulnodeb, 7);
<a name="l00272"></a>00272     
<a name="l00273"></a>00273 
<a name="l00274"></a>00274      <span class="keywordtype">double</span>* coord;
<a name="l00275"></a>00275      <span class="keywordtype">int</span> node_GID;
<a name="l00276"></a>00276      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node_LID;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][0]-1;
<a name="l00279"></a>00279      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00280"></a>00280      coord = stk::mesh::field_data(*coordinates_field, llnode);
<a name="l00281"></a>00281      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00282"></a>00282 
<a name="l00283"></a>00283      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][1]-1;
<a name="l00284"></a>00284      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00285"></a>00285      coord = stk::mesh::field_data(*coordinates_field, lrnode);
<a name="l00286"></a>00286      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00287"></a>00287 
<a name="l00288"></a>00288      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][2]-1;
<a name="l00289"></a>00289      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00290"></a>00290      coord = stk::mesh::field_data(*coordinates_field, urnode);
<a name="l00291"></a>00291      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00292"></a>00292 
<a name="l00293"></a>00293      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][3]-1;
<a name="l00294"></a>00294      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00295"></a>00295      coord = stk::mesh::field_data(*coordinates_field, ulnode);
<a name="l00296"></a>00296      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00297"></a>00297 
<a name="l00298"></a>00298      coord = stk::mesh::field_data(*coordinates_field, llnodeb);
<a name="l00299"></a>00299      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][4]-1;
<a name="l00300"></a>00300      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00301"></a>00301      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00302"></a>00302 
<a name="l00303"></a>00303      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][5]-1;
<a name="l00304"></a>00304      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00305"></a>00305      coord = stk::mesh::field_data(*coordinates_field, lrnodeb);
<a name="l00306"></a>00306      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00307"></a>00307 
<a name="l00308"></a>00308      coord = stk::mesh::field_data(*coordinates_field, urnodeb);
<a name="l00309"></a>00309      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][6]-1;
<a name="l00310"></a>00310      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00311"></a>00311      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00312"></a>00312 
<a name="l00313"></a>00313      coord = stk::mesh::field_data(*coordinates_field, ulnodeb);
<a name="l00314"></a>00314      node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][7]-1;
<a name="l00315"></a>00315      node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00316"></a>00316      coord[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[node_LID][2];
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="preprocessor">#ifdef ALBANY_FELIX</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span>     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a556f99becbe0f25d7e66c0a52705a63a">have_sh</a>) {
<a name="l00320"></a>00320        <span class="keywordtype">double</span>* sHeight;
<a name="l00321"></a>00321        sHeight = stk::mesh::field_data(*surfaceHeight_field, llnode);
<a name="l00322"></a>00322        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][0]-1;
<a name="l00323"></a>00323        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00324"></a>00324        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00325"></a>00325 
<a name="l00326"></a>00326        sHeight = stk::mesh::field_data(*surfaceHeight_field, lrnode);
<a name="l00327"></a>00327        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][1]-1;
<a name="l00328"></a>00328        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00329"></a>00329        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00330"></a>00330 
<a name="l00331"></a>00331        sHeight = stk::mesh::field_data(*surfaceHeight_field, urnode);
<a name="l00332"></a>00332        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][2]-1;
<a name="l00333"></a>00333        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00334"></a>00334        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00335"></a>00335 
<a name="l00336"></a>00336        sHeight = stk::mesh::field_data(*surfaceHeight_field, ulnode);
<a name="l00337"></a>00337        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][3]-1;
<a name="l00338"></a>00338        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00339"></a>00339        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00340"></a>00340 
<a name="l00341"></a>00341        sHeight = stk::mesh::field_data(*surfaceHeight_field, llnodeb);
<a name="l00342"></a>00342        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][4]-1;
<a name="l00343"></a>00343        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00344"></a>00344        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00345"></a>00345 
<a name="l00346"></a>00346        sHeight = stk::mesh::field_data(*surfaceHeight_field, lrnodeb);
<a name="l00347"></a>00347        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][5]-1;
<a name="l00348"></a>00348        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00349"></a>00349        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00350"></a>00350 
<a name="l00351"></a>00351        sHeight = stk::mesh::field_data(*surfaceHeight_field, urnodeb);
<a name="l00352"></a>00352        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][6]-1;
<a name="l00353"></a>00353        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00354"></a>00354        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00355"></a>00355 
<a name="l00356"></a>00356        sHeight = stk::mesh::field_data(*surfaceHeight_field, ulnodeb);
<a name="l00357"></a>00357        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][7]-1;
<a name="l00358"></a>00358        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00359"></a>00359        sHeight[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a29e1a0657f3b27cc4a62af1b130cd706">sh</a>[node_LID];
<a name="l00360"></a>00360      }
<a name="l00361"></a>00361      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a1f151457ea80b9049855fd436c8ebc95">have_flwa</a>) {
<a name="l00362"></a>00362        <span class="keywordtype">double</span> *flowFactor = stk::mesh::field_data(*flowFactor_field, elem); 
<a name="l00363"></a>00363        <span class="comment">//i is elem_LID (element local ID);</span>
<a name="l00364"></a>00364        <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt;&quot;, flwa: &quot; &lt;&lt; flwa[i] &lt;&lt; std::endl;  </span>
<a name="l00365"></a>00365        flowFactor[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a739705c1f7d256f5255fc3e9a722d351">flwa</a>[i]; 
<a name="l00366"></a>00366      }
<a name="l00367"></a>00367      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a0e9310bc6e86f6e3781cb1a299eddc90">have_temp</a>) {
<a name="l00368"></a>00368        <span class="keywordtype">double</span> *temperature = stk::mesh::field_data(*temperature_field, elem); 
<a name="l00369"></a>00369        <span class="comment">//i is elem_LID (element local ID);</span>
<a name="l00370"></a>00370        <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt;&quot;, temp: &quot; &lt;&lt; temperature[i] &lt;&lt; std::endl;  </span>
<a name="l00371"></a>00371        temperature[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a81fe64f0080c0b06e56a34855c2b4c51">temper</a>[i]; 
<a name="l00372"></a>00372      }
<a name="l00373"></a>00373      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#afcff7d985fbf9249972ef955f71b2fae">have_beta</a>) {
<a name="l00374"></a>00374        <span class="keywordtype">double</span>* bFriction; 
<a name="l00375"></a>00375        bFriction = stk::mesh::field_data(*basal_friction_field, llnode);
<a name="l00376"></a>00376        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][0]-1;
<a name="l00377"></a>00377        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00378"></a>00378        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00379"></a>00379 
<a name="l00380"></a>00380        bFriction = stk::mesh::field_data(*basal_friction_field, lrnode);
<a name="l00381"></a>00381        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][1]-1;
<a name="l00382"></a>00382        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00383"></a>00383        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00384"></a>00384 
<a name="l00385"></a>00385        bFriction = stk::mesh::field_data(*basal_friction_field, urnode);
<a name="l00386"></a>00386        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][2]-1;
<a name="l00387"></a>00387        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00388"></a>00388        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00389"></a>00389 
<a name="l00390"></a>00390        bFriction = stk::mesh::field_data(*basal_friction_field, ulnode);
<a name="l00391"></a>00391        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][3]-1;
<a name="l00392"></a>00392        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00393"></a>00393        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00394"></a>00394 
<a name="l00395"></a>00395        bFriction = stk::mesh::field_data(*basal_friction_field, llnodeb);
<a name="l00396"></a>00396        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][4]-1;
<a name="l00397"></a>00397        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00398"></a>00398        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00399"></a>00399 
<a name="l00400"></a>00400        bFriction = stk::mesh::field_data(*basal_friction_field, lrnodeb);
<a name="l00401"></a>00401        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][5]-1;
<a name="l00402"></a>00402        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00403"></a>00403        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00404"></a>00404 
<a name="l00405"></a>00405        bFriction = stk::mesh::field_data(*basal_friction_field, urnodeb);
<a name="l00406"></a>00406        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][6]-1;
<a name="l00407"></a>00407        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00408"></a>00408        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID];
<a name="l00409"></a>00409 
<a name="l00410"></a>00410        bFriction = stk::mesh::field_data(*basal_friction_field, ulnodeb);
<a name="l00411"></a>00411        node_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][7]-1;
<a name="l00412"></a>00412        node_LID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a89d1f700099ce80bb57f4f545e5e3337">node_map</a>-&gt;LID(node_GID);
<a name="l00413"></a>00413        bFriction[0] = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a99eb6c1de10ab1333a51b9a82fdfa540">beta</a>[node_LID]; 
<a name="l00414"></a>00414        }
<a name="l00415"></a>00415 <span class="preprocessor">#endif</span>
<a name="l00416"></a>00416 <span class="preprocessor"></span>
<a name="l00417"></a>00417      <span class="comment">// If first node has z=0 and there is no basal face file provided, identify it as a Basal SS</span>
<a name="l00418"></a>00418      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a> == <span class="keyword">false</span>) {
<a name="l00419"></a>00419        std::cout &lt;&lt;<span class="stringliteral">&quot;No bf file specified...  setting basal boundary to z=0 plane...&quot;</span> &lt;&lt; std::endl; 
<a name="l00420"></a>00420        <span class="keywordflow">if</span> ( <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af1f53e33cc9bb7f69d4c8ca57d26703a">xyz</a>[<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#af48467f317434f93a8f25ba95de97ba8">eles</a>[i][0]][2] == 0.0) {
<a name="l00421"></a>00421           <span class="comment">//std::cout &lt;&lt; &quot;sideID: &quot; &lt;&lt; sideID &lt;&lt; std::endl; </span>
<a name="l00422"></a>00422           singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[<span class="stringliteral">&quot;Basal&quot;</span>];
<a name="l00423"></a>00423           stk::mesh::EntityId side_id = (stk::mesh::EntityId)(sideID);
<a name="l00424"></a>00424           sideID++;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426          <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; side  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank(), 1 + side_id, singlePartVec);
<a name="l00427"></a>00427          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, side,  4 <span class="comment">/*local side id*/</span>);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, llnode, 0);
<a name="l00430"></a>00430          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, ulnode, 3);
<a name="l00431"></a>00431          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, urnode, 2);
<a name="l00432"></a>00432          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, lrnode, 1);
<a name="l00433"></a>00433        }
<a name="l00434"></a>00434      }
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a25557cf687fd46b20f2c496ac4cb98af">have_bf</a> == <span class="keyword">true</span>) {
<a name="l00438"></a>00438     *<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#aa21ce4dc601244f78d2075ffc6c0d0e8">out</a> &lt;&lt; <span class="stringliteral">&quot;Setting basal surface connectivity from bf file provided...&quot;</span> &lt;&lt; std::endl;  
<a name="l00439"></a>00439     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ab6ad846611268075fa645a46a514910f">basal_face_map</a>-&gt;NumMyElements(); i++) {
<a name="l00440"></a>00440        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[<span class="stringliteral">&quot;Basal&quot;</span>];
<a name="l00441"></a>00441        sideID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#ab6ad846611268075fa645a46a514910f">basal_face_map</a>-&gt;GID(i); 
<a name="l00442"></a>00442        stk::mesh::EntityId side_id = (stk::mesh::EntityId)(sideID);
<a name="l00443"></a>00443        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; side  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank(),side_id+1, singlePartVec);
<a name="l00444"></a>00444        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_GID = <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][0];
<a name="l00445"></a>00445        stk::mesh::EntityId elem_id = (stk::mesh::EntityId) elem_GID;
<a name="l00446"></a>00446        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; elem  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank(), elem_id, emptyPartVec);
<a name="l00447"></a>00447        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, side,  4 <span class="comment">/*local side id*/</span>);
<a name="l00448"></a>00448        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][1], nodePartVec);
<a name="l00449"></a>00449        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][2], nodePartVec);
<a name="l00450"></a>00450        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][3], nodePartVec);
<a name="l00451"></a>00451        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a18606d6c4091ffacbeae1339541af486">bf</a>[i][4], nodePartVec);
<a name="l00452"></a>00452        
<a name="l00453"></a>00453        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, llnode, 0);
<a name="l00454"></a>00454        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, ulnode, 3);
<a name="l00455"></a>00455        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, urnode, 2);
<a name="l00456"></a>00456        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, lrnode, 1);
<a name="l00457"></a>00457     }
<a name="l00458"></a>00458   }
<a name="l00459"></a>00459   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;modification_end();
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 Teuchos::RCP&lt;const Teuchos::ParameterList&gt;
<a name="l00463"></a><a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a228d7f5d6f70048a8bbcf497073685d6">00463</a> <a class="code" href="classAlbany_1_1CismSTKMeshStruct.html#a228d7f5d6f70048a8bbcf497073685d6">Albany::CismSTKMeshStruct::getValidDiscretizationParameters</a>()<span class="keyword"> const</span>
<a name="l00464"></a>00464 <span class="keyword"></span>{
<a name="l00465"></a>00465   Teuchos::RCP&lt;Teuchos::ParameterList&gt; validPL =
<a name="l00466"></a>00466     this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#a81cdcb00e08a795989c5ea1b859da13d">getValidGenericSTKParameters</a>(<span class="stringliteral">&quot;Valid ASCII_DiscParams&quot;</span>);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   <span class="keywordflow">return</span> validPL;
<a name="l00469"></a>00469 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 26 2014 18:36:36 for Albany: a Trilinos-based PDE code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
