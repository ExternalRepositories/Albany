<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Albany: a Trilinos-based PDE code: Albany_AsciiSTKMeshStruct.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>Albany_AsciiSTKMeshStruct.cpp</h1>  </div>
</div>
<div class="contents">
<a href="Albany__AsciiSTKMeshStruct_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************//</span>
<a name="l00002"></a>00002 <span class="comment">//    Albany 2.0:  Copyright 2012 Sandia Corporation               //</span>
<a name="l00003"></a>00003 <span class="comment">//    This Software is released under the BSD license detailed     //</span>
<a name="l00004"></a>00004 <span class="comment">//    in the file &quot;license.txt&quot; in the top-level Albany directory  //</span>
<a name="l00005"></a>00005 <span class="comment">//*****************************************************************//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="Albany__AsciiSTKMeshStruct_8hpp.html">Albany_AsciiSTKMeshStruct.hpp</a>&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;Teuchos_VerboseObject.hpp&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;Shards_BasicTopologies.hpp&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;stk_mesh/base/Entity.hpp&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;stk_mesh/base/GetEntities.hpp&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stk_mesh/base/GetBuckets.hpp&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;stk_mesh/base/FieldData.hpp&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;stk_mesh/base/Selector.hpp&gt;</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stk_io/IossBridge.hpp&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#endif</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="comment">//#include &lt;stk_mesh/fem/FEMHelpers.hpp&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;boost/algorithm/string/predicate.hpp&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="Albany__Utils_8hpp.html">Albany_Utils.hpp</a>&quot;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">//uncomment the following line if you want debug output to be printed to screen</span>
<a name="l00032"></a>00032 <span class="comment">//#define OUTPUT_TO_SCREEN</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">//Constructor for meshes read from ASCII file </span>
<a name="l00036"></a><a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ad9d3e211db4235c4592da07c65e34060">00036</a> <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ad9d3e211db4235c4592da07c65e34060">Albany::AsciiSTKMeshStruct::AsciiSTKMeshStruct</a>(
<a name="l00037"></a>00037                                              <span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; params, 
<a name="l00038"></a>00038                                              <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>) :
<a name="l00039"></a>00039   <a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html">GenericSTKMeshStruct</a>(params,Teuchos::null,3),
<a name="l00040"></a>00040   out(Teuchos::VerboseObjectBase::getDefaultOStream()),
<a name="l00041"></a>00041   periodic(false)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043    <span class="keywordtype">int</span> numProc = comm-&gt;NumProc(); <span class="comment">//total number of processors</span>
<a name="l00044"></a>00044    <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> = params-&gt;get(<span class="stringliteral">&quot;Contiguous IDs&quot;</span>, <span class="keyword">true</span>); 
<a name="l00045"></a>00045    std::cout &lt;&lt; <span class="stringliteral">&quot;Number of processors: &quot;</span> &lt;&lt; numProc &lt;&lt; std::endl; 
<a name="l00046"></a>00046    <span class="comment">//names of files giving the mesh</span>
<a name="l00047"></a>00047    <span class="keywordtype">char</span> meshfilename[100]; 
<a name="l00048"></a>00048    <span class="keywordtype">char</span> shfilename[100];
<a name="l00049"></a>00049    <span class="keywordtype">char</span> confilename[100];
<a name="l00050"></a>00050    <span class="keywordtype">char</span> bffilename[100];
<a name="l00051"></a>00051    <span class="keywordtype">char</span> geIDsfilename[100];
<a name="l00052"></a>00052    <span class="keywordtype">char</span> gnIDsfilename[100];
<a name="l00053"></a>00053    <span class="keywordtype">char</span> bfIDsfilename[100];
<a name="l00054"></a>00054    <span class="keywordtype">char</span> flwafilename[100]; <span class="comment">//flow factor file</span>
<a name="l00055"></a>00055    <span class="keywordtype">char</span> tempfilename[100]; <span class="comment">//temperature file</span>
<a name="l00056"></a>00056    <span class="keywordtype">char</span> betafilename[100]; <span class="comment">//basal friction coefficient file</span>
<a name="l00057"></a>00057    <span class="keywordflow">if</span> ((numProc == 1) &amp; (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> == <span class="keyword">true</span>)) { <span class="comment">//serial run with contiguous global IDs</span>
<a name="l00058"></a>00058 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>     std::cout &lt;&lt; <span class="stringliteral">&quot;Ascii mesh has contiguous IDs; no bfIDs, geIDs, gnIDs files required.&quot;</span> &lt;&lt; std::endl;
<a name="l00060"></a>00060 <span class="preprocessor">#endif</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>     sprintf(meshfilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;xyz&quot;</span>);
<a name="l00062"></a>00062      sprintf(shfilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>);
<a name="l00063"></a>00063      sprintf(confilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;eles&quot;</span>);
<a name="l00064"></a>00064      sprintf(bffilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;bf&quot;</span>);
<a name="l00065"></a>00065      sprintf(flwafilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;flwa&quot;</span>);
<a name="l00066"></a>00066      sprintf(tempfilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;temp&quot;</span>);
<a name="l00067"></a>00067      sprintf(betafilename, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;beta&quot;</span>);
<a name="l00068"></a>00068    }
<a name="l00069"></a>00069    <span class="keywordflow">else</span> { <span class="comment">//parallel run or serial run with non-contiguous global IDs - proc # is appended to file name to indicate what processor the mesh piece is on </span>
<a name="l00070"></a>00070 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span>     <span class="keywordflow">if</span> ((numProc == 1) &amp; (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> == <span class="keyword">false</span>))
<a name="l00072"></a>00072         std::cout &lt;&lt; <span class="stringliteral">&quot;1 processor run with non-contiguous IDs; bfIDs0, geIDs0, gnIDs0 files required.&quot;</span> &lt;&lt; std::endl;
<a name="l00073"></a>00073 <span class="preprocessor">#endif</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span>     <span class="keywordtype">int</span> suffix = comm-&gt;MyPID(); <span class="comment">//current processor number </span>
<a name="l00075"></a>00075      sprintf(meshfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;xyz&quot;</span>, suffix);
<a name="l00076"></a>00076      sprintf(shfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>, suffix);
<a name="l00077"></a>00077      sprintf(confilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;eles&quot;</span>, suffix);
<a name="l00078"></a>00078      sprintf(bffilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;bf&quot;</span>, suffix);
<a name="l00079"></a>00079      sprintf(geIDsfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;geIDs&quot;</span>, suffix);
<a name="l00080"></a>00080      sprintf(gnIDsfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;gnIDs&quot;</span>, suffix);
<a name="l00081"></a>00081      sprintf(bfIDsfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;bfIDs&quot;</span>, suffix);
<a name="l00082"></a>00082      sprintf(flwafilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;flwa&quot;</span>, suffix);
<a name="l00083"></a>00083      sprintf(tempfilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;temp&quot;</span>, suffix);
<a name="l00084"></a>00084      sprintf(betafilename, <span class="stringliteral">&quot;%s%i&quot;</span>, <span class="stringliteral">&quot;beta&quot;</span>, suffix);
<a name="l00085"></a>00085    }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     <span class="comment">//read in coordinates of mesh -- right now hard coded for 3D</span>
<a name="l00088"></a>00088     <span class="comment">//assumes mesh file is called &quot;xyz&quot; and its first row is the number of nodes  </span>
<a name="l00089"></a>00089     FILE *meshfile = fopen(meshfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00090"></a>00090     <span class="keywordflow">if</span> (meshfile == NULL) { <span class="comment">//check if coordinates file exists</span>
<a name="l00091"></a>00091       *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: coordinates file &quot;</span> &lt;&lt; meshfilename &lt;&lt;<span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl;
<a name="l00092"></a>00092       TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, Teuchos::Exceptions::InvalidParameter,
<a name="l00093"></a>00093           std::endl &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: coordinates file &quot;</span> &lt;&lt; meshfilename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl);
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095     <span class="keywordtype">double</span> temp; 
<a name="l00096"></a>00096     fseek(meshfile, 0, SEEK_SET); 
<a name="l00097"></a>00097     fscanf(meshfile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00098"></a>00098     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ab633e9ae2d48dfe2b693bbc5f3d89465">NumNodes</a> = int(temp); 
<a name="l00099"></a>00099 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>    *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;numNodes: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ab633e9ae2d48dfe2b693bbc5f3d89465">NumNodes</a> &lt;&lt; std::endl;  
<a name="l00101"></a>00101 <span class="preprocessor">#endif</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>    <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ab633e9ae2d48dfe2b693bbc5f3d89465">NumNodes</a>][3]; 
<a name="l00103"></a>00103     <span class="keywordtype">char</span> buffer[100];
<a name="l00104"></a>00104     fgets(buffer, 100, meshfile); 
<a name="l00105"></a>00105     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ab633e9ae2d48dfe2b693bbc5f3d89465">NumNodes</a>; i++){
<a name="l00106"></a>00106       fgets(buffer, 100, meshfile); 
<a name="l00107"></a>00107       sscanf(buffer, <span class="stringliteral">&quot;%lf %lf %lf&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[i][0], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[i][1], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[i][2]); 
<a name="l00108"></a>00108       <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, x: &quot; &lt;&lt; xyz[i][0] &lt;&lt; &quot;, y: &quot; &lt;&lt; xyz[i][1] &lt;&lt; &quot;, z: &quot; &lt;&lt; xyz[i][2] &lt;&lt; std::endl; </span>
<a name="l00109"></a>00109      }
<a name="l00110"></a>00110     <span class="comment">//read in surface height data from mesh </span>
<a name="l00111"></a>00111     <span class="comment">//assumes surface height file is called &quot;sh&quot; and its first row is the number of nodes  </span>
<a name="l00112"></a>00112     FILE *shfile = fopen(shfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00113"></a>00113     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a> = <span class="keyword">false</span>;
<a name="l00114"></a>00114     <span class="keywordflow">if</span> (shfile != NULL) <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a> = <span class="keyword">true</span>;
<a name="l00115"></a>00115     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a>) {
<a name="l00116"></a>00116       fseek(shfile, 0, SEEK_SET); 
<a name="l00117"></a>00117       fscanf(shfile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00118"></a>00118       <span class="keywordtype">int</span> NumNodesSh = int(temp);
<a name="l00119"></a>00119 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>      *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;NumNodesSh: &quot;</span> &lt;&lt; NumNodesSh&lt;&lt; std::endl;
<a name="l00121"></a>00121 <span class="preprocessor">#endif </span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (NumNodesSh != NumNodes) { 
<a name="l00123"></a>00123            *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: sh file must have same number nodes as xyz file!  numNodes in xyz = &quot;</span> &lt;&lt; NumNodes &lt;&lt;<span class="stringliteral">&quot;, numNodes in sh = &quot;</span>&lt;&lt; NumNodesSh  &lt;&lt; std::endl;
<a name="l00124"></a>00124           TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, Teuchos::Exceptions::InvalidParameter,
<a name="l00125"></a>00125             std::endl &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: sh file must have same number nodes as xyz file!  numNodes in xyz = &quot;</span> &lt;&lt; NumNodes &lt;&lt; <span class="stringliteral">&quot;, numNodes in sh = &quot;</span>&lt;&lt; NumNodesSh &lt;&lt; std::endl);
<a name="l00126"></a>00126       }
<a name="l00127"></a>00127       <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[NumNodes]; 
<a name="l00128"></a>00128       fgets(buffer, 100, shfile); 
<a name="l00129"></a>00129       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++){
<a name="l00130"></a>00130         fgets(buffer, 100, shfile); 
<a name="l00131"></a>00131         sscanf(buffer, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[i]); 
<a name="l00132"></a>00132         <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, sh: &quot; &lt;&lt; sh[i] &lt;&lt; std::endl; </span>
<a name="l00133"></a>00133        }
<a name="l00134"></a>00134      }
<a name="l00135"></a>00135      <span class="comment">//read in connectivity file -- right now hard coded for 3D hexes</span>
<a name="l00136"></a>00136      <span class="comment">//assumes mesh file is called &quot;eles&quot; and its first row is the number of elements  </span>
<a name="l00137"></a>00137      FILE *confile = fopen(confilename,<span class="stringliteral">&quot;r&quot;</span>); 
<a name="l00138"></a>00138      <span class="keywordflow">if</span> (confile == NULL) { <span class="comment">//check if element connectivity file exists</span>
<a name="l00139"></a>00139       *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: element connectivity file &quot;</span> &lt;&lt; confilename &lt;&lt;<span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl;
<a name="l00140"></a>00140       TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, Teuchos::Exceptions::InvalidParameter,
<a name="l00141"></a>00141           std::endl &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: element connectivity file &quot;</span> &lt;&lt; confilename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl);
<a name="l00142"></a>00142      }
<a name="l00143"></a>00143      fseek(confile, 0, SEEK_SET); 
<a name="l00144"></a>00144      fscanf(confile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00145"></a>00145      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a29f8e2fab8495748e20df684be6bfa52">NumEles</a> = int(temp); 
<a name="l00146"></a>00146 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00147"></a>00147 <span class="preprocessor"></span>     *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;numEles: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a29f8e2fab8495748e20df684be6bfa52">NumEles</a> &lt;&lt; std::endl;
<a name="l00148"></a>00148 <span class="preprocessor">#endif </span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a29f8e2fab8495748e20df684be6bfa52">NumEles</a>][8]; 
<a name="l00150"></a>00150      fgets(buffer, 100, confile); 
<a name="l00151"></a>00151      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a29f8e2fab8495748e20df684be6bfa52">NumEles</a>; i++){
<a name="l00152"></a>00152         fgets(buffer, 100, confile); 
<a name="l00153"></a>00153         sscanf(buffer, <span class="stringliteral">&quot;%i %i %i %i %i %i %i %i&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][3], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][5], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][6], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][7]);
<a name="l00154"></a>00154         <span class="comment">//*out &lt;&lt; &quot;elt # &quot; &lt;&lt; i &lt;&lt; &quot;: &quot; &lt;&lt; eles[i][0] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][1] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][2] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][3] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][4] &lt;&lt; &quot; &quot;</span>
<a name="l00155"></a>00155         <span class="comment">//                  &lt;&lt; eles[i][5] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][6] &lt;&lt; &quot; &quot; &lt;&lt; eles[i][7] &lt;&lt; std::endl; </span>
<a name="l00156"></a>00156      }
<a name="l00157"></a>00157     <span class="comment">//read in basal face connectivity file from ascii file</span>
<a name="l00158"></a>00158     <span class="comment">//assumes basal face connectivity file is called &quot;bf&quot; and its first row is the number of faces on basal boundary</span>
<a name="l00159"></a>00159     FILE *bffile = fopen(bffilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00160"></a>00160     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a> = <span class="keyword">false</span>;
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (bffile != NULL) <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a> = <span class="keyword">true</span>;
<a name="l00162"></a>00162     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a>) {
<a name="l00163"></a>00163       fseek(bffile, 0, SEEK_SET); 
<a name="l00164"></a>00164       fscanf(bffile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00165"></a>00165       <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a> = int(temp); 
<a name="l00166"></a>00166 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00167"></a>00167 <span class="preprocessor"></span>      *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;numBasalFaces: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a> &lt;&lt; std::endl;  
<a name="l00168"></a>00168 <span class="preprocessor">#endif</span>
<a name="l00169"></a>00169 <span class="preprocessor"></span>      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>][5]; <span class="comment">//1st column of bf: element # that face belongs to, 2rd-5th columns of bf: connectivity (hard-coded for quad faces) </span>
<a name="l00170"></a>00170       fgets(buffer, 100, bffile); 
<a name="l00171"></a>00171       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>; i++){
<a name="l00172"></a>00172         fgets(buffer, 100, bffile); 
<a name="l00173"></a>00173         sscanf(buffer, <span class="stringliteral">&quot;%i %i %i %i %i&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][0], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][1], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][2], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][3], &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][4]); 
<a name="l00174"></a>00174         <span class="comment">//*out &lt;&lt; &quot;face #:&quot; &lt;&lt; bf[i][0] &lt;&lt; &quot;, face conn:&quot; &lt;&lt; bf[i][1] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][2] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][3] &lt;&lt; &quot; &quot; &lt;&lt; bf[i][4] &lt;&lt; std::endl; </span>
<a name="l00175"></a>00175        }
<a name="l00176"></a>00176      }
<a name="l00177"></a>00177      <span class="comment">//Create array w/ global element IDs </span>
<a name="l00178"></a>00178      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[NumEles];
<a name="l00179"></a>00179      <span class="keywordflow">if</span> ((numProc == 1) &amp; (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> == <span class="keyword">true</span>)) { <span class="comment">//serial run with contiguous global IDs: element IDs are just 0-&gt;NumEles-1</span>
<a name="l00180"></a>00180        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumEles; i++) {
<a name="l00181"></a>00181           <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>[i] = i; 
<a name="l00182"></a>00182           <span class="comment">//*out &lt;&lt; &quot;local element ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global element ID #:&quot; &lt;&lt; globalElesID[i] &lt;&lt; std::endl;</span>
<a name="l00183"></a>00183        }
<a name="l00184"></a>00184      }
<a name="l00185"></a>00185      <span class="keywordflow">else</span> {<span class="comment">//parallel run: read global element IDs from file.  </span>
<a name="l00186"></a>00186            <span class="comment">//This file should have a header like the other files, and length NumEles.</span>
<a name="l00187"></a>00187        FILE *geIDsfile = fopen(geIDsfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00188"></a>00188        <span class="keywordflow">if</span> (geIDsfile == NULL) { <span class="comment">//check if global element IDs file exists</span>
<a name="l00189"></a>00189          *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: global element IDs file &quot;</span> &lt;&lt; geIDsfilename &lt;&lt;<span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl;
<a name="l00190"></a>00190          TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, Teuchos::Exceptions::InvalidParameter,
<a name="l00191"></a>00191             std::endl &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: global element IDs file &quot;</span> &lt;&lt; geIDsfilename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl);
<a name="l00192"></a>00192        }
<a name="l00193"></a>00193        fseek(geIDsfile, 0, SEEK_SET);
<a name="l00194"></a>00194        fgets(buffer, 100, geIDsfile);
<a name="l00195"></a>00195        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumEles; i++){
<a name="l00196"></a>00196          fgets(buffer, 100, geIDsfile);
<a name="l00197"></a>00197          sscanf(buffer, <span class="stringliteral">&quot;%i &quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>[i]);
<a name="l00198"></a>00198          <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>[i] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>[i]-1; <span class="comment">//subtract 1 b/c global element IDs file assumed to be 1-based not 0-based</span>
<a name="l00199"></a>00199          <span class="comment">//*out &lt;&lt; &quot;local element ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global element ID #:&quot; &lt;&lt; globalElesID[i] &lt;&lt; std::endl;</span>
<a name="l00200"></a>00200        }
<a name="l00201"></a>00201      }
<a name="l00202"></a>00202      <span class="comment">//Create array w/ global node IDs </span>
<a name="l00203"></a>00203      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[NumNodes];
<a name="l00204"></a>00204      <span class="keywordflow">if</span> ((numProc == 1) &amp; (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> == <span class="keyword">true</span>)) { <span class="comment">//serial run with contiguous global IDs: element IDs are just 0-&gt;NumEles-1</span>
<a name="l00205"></a>00205        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++) { 
<a name="l00206"></a>00206           <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>[i] = i; 
<a name="l00207"></a>00207           <span class="comment">//*out &lt;&lt; &quot;local node ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global node ID #:&quot; &lt;&lt; globalNodesID[i] &lt;&lt; std::endl;</span>
<a name="l00208"></a>00208        }
<a name="l00209"></a>00209      }
<a name="l00210"></a>00210      <span class="keywordflow">else</span> {<span class="comment">//parallel run: read global node IDs from file.  </span>
<a name="l00211"></a>00211            <span class="comment">//This file should have a header like the other files, and length NumNodes</span>
<a name="l00212"></a>00212        FILE *gnIDsfile = fopen(gnIDsfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00213"></a>00213        <span class="keywordflow">if</span> (gnIDsfile == NULL) { <span class="comment">//check if global node IDs file exists</span>
<a name="l00214"></a>00214          *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: global node IDs file &quot;</span> &lt;&lt; gnIDsfilename &lt;&lt;<span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl;
<a name="l00215"></a>00215          TEUCHOS_TEST_FOR_EXCEPTION(<span class="keyword">true</span>, Teuchos::Exceptions::InvalidParameter,
<a name="l00216"></a>00216             std::endl &lt;&lt; <span class="stringliteral">&quot;Error in AsciiSTKMeshStruct: global node IDs file &quot;</span> &lt;&lt; gnIDsfilename &lt;&lt; <span class="stringliteral">&quot; not found!&quot;</span>&lt;&lt; std::endl);
<a name="l00217"></a>00217        }
<a name="l00218"></a>00218        fseek(gnIDsfile, 0, SEEK_SET);
<a name="l00219"></a>00219        fgets(buffer, 100, gnIDsfile);
<a name="l00220"></a>00220        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++){
<a name="l00221"></a>00221          fgets(buffer, 100, gnIDsfile);
<a name="l00222"></a>00222          sscanf(buffer, <span class="stringliteral">&quot;%i &quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>[i]);
<a name="l00223"></a>00223          <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>[i] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>[i]-1; <span class="comment">//subtract 1 b/c global node IDs file assumed to be 1-based not 0-based </span>
<a name="l00224"></a>00224          <span class="comment">//*out &lt;&lt; &quot;local node ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global node ID #:&quot; &lt;&lt; globalNodesID[i] &lt;&lt; std::endl;</span>
<a name="l00225"></a>00225        }
<a name="l00226"></a>00226      }
<a name="l00227"></a>00227      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>];
<a name="l00228"></a>00228      <span class="keywordflow">if</span> ((numProc == 1) &amp; (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a25b8459f5d123ab56bee42ed07fb3f99">contigIDs</a> == <span class="keyword">true</span>)) { <span class="comment">//serial run with contiguous global IDs: element IDs are just 0-&gt;NumEles-1</span>
<a name="l00229"></a>00229        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>; i++) { 
<a name="l00230"></a>00230           <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>[i] = i; 
<a name="l00231"></a>00231           <span class="comment">//*out &lt;&lt; &quot;local face ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global face ID #:&quot; &lt;&lt; basalFacesID[i] &lt;&lt; std::endl;</span>
<a name="l00232"></a>00232        }
<a name="l00233"></a>00233      }
<a name="l00234"></a>00234      <span class="keywordflow">else</span> {<span class="comment">//parallel run: read basal face IDs from file.  </span>
<a name="l00235"></a>00235            <span class="comment">//This file should have a header like the other files, and length NumBasalFaces</span>
<a name="l00236"></a>00236        FILE *bfIDsfile = fopen(bfIDsfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00237"></a>00237        fseek(bfIDsfile, 0, SEEK_SET);
<a name="l00238"></a>00238        fgets(buffer, 100, bfIDsfile);
<a name="l00239"></a>00239        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>; i++){
<a name="l00240"></a>00240          fgets(buffer, 100, bfIDsfile);
<a name="l00241"></a>00241          sscanf(buffer, <span class="stringliteral">&quot;%i &quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>[i]);
<a name="l00242"></a>00242          <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>[i] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>[i]-1; <span class="comment">//subtract 1 b/c basal face IDs file assumed to be 1-based not 0-based</span>
<a name="l00243"></a>00243          <span class="comment">//*out &lt;&lt; &quot;local face ID #:&quot; &lt;&lt; i &lt;&lt; &quot;, global face ID #:&quot; &lt;&lt; basalFacesID[i] &lt;&lt; std::endl;</span>
<a name="l00244"></a>00244        }
<a name="l00245"></a>00245      }
<a name="l00246"></a>00246     <span class="comment">//read in flow factor (flwa) data from mesh </span>
<a name="l00247"></a>00247     <span class="comment">//assumes flow factor file is called &quot;flwa&quot; and its first row is the number of elements in the mesh</span>
<a name="l00248"></a>00248     FILE *flwafile = fopen(flwafilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00249"></a>00249     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a694c5e919d741eacad2afcc24b16de39">have_flwa</a> = <span class="keyword">false</span>;
<a name="l00250"></a>00250     <span class="keywordflow">if</span> (flwafile != NULL) <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a694c5e919d741eacad2afcc24b16de39">have_flwa</a> = <span class="keyword">true</span>;
<a name="l00251"></a>00251     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a694c5e919d741eacad2afcc24b16de39">have_flwa</a>) {
<a name="l00252"></a>00252       fseek(flwafile, 0, SEEK_SET); 
<a name="l00253"></a>00253       fscanf(flwafile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00254"></a>00254       <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af4e481afcb2e9d8c2df271525ba5541e">flwa</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[NumEles]; 
<a name="l00255"></a>00255       fgets(buffer, 100, flwafile); 
<a name="l00256"></a>00256       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumEles; i++){
<a name="l00257"></a>00257         fgets(buffer, 100, flwafile); 
<a name="l00258"></a>00258         sscanf(buffer, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af4e481afcb2e9d8c2df271525ba5541e">flwa</a>[i]); 
<a name="l00259"></a>00259         <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, flwa: &quot; &lt;&lt; flwa[i] &lt;&lt; std::endl; </span>
<a name="l00260"></a>00260        }
<a name="l00261"></a>00261      }
<a name="l00262"></a>00262     <span class="comment">//read in temperature data from mesh </span>
<a name="l00263"></a>00263     <span class="comment">//assumes temperature file is called &quot;temp&quot; and its first row is the number of elements in the mesh</span>
<a name="l00264"></a>00264     FILE *tempfile = fopen(tempfilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00265"></a>00265     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a49aecf489f410be1f35b37b5e1151448">have_temp</a> = <span class="keyword">false</span>;
<a name="l00266"></a>00266     <span class="keywordflow">if</span> (tempfile != NULL) <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a49aecf489f410be1f35b37b5e1151448">have_temp</a> = <span class="keyword">true</span>;
<a name="l00267"></a>00267     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a49aecf489f410be1f35b37b5e1151448">have_temp</a>) {
<a name="l00268"></a>00268       fseek(tempfile, 0, SEEK_SET); 
<a name="l00269"></a>00269       fscanf(tempfile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00270"></a>00270       <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a75b26227af61da6a00890d7c776ab1e9">temper</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[NumEles]; 
<a name="l00271"></a>00271       fgets(buffer, 100, tempfile); 
<a name="l00272"></a>00272       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumEles; i++){
<a name="l00273"></a>00273         fgets(buffer, 100, tempfile); 
<a name="l00274"></a>00274         sscanf(buffer, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a75b26227af61da6a00890d7c776ab1e9">temper</a>[i]); 
<a name="l00275"></a>00275         <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, temp: &quot; &lt;&lt; temper[i] &lt;&lt; std::endl; </span>
<a name="l00276"></a>00276        }
<a name="l00277"></a>00277      }
<a name="l00278"></a>00278     <span class="comment">//read in basal friction (beta) data from mesh </span>
<a name="l00279"></a>00279     <span class="comment">//assumes basal friction file is called &quot;beta&quot; and its first row is the number of nodes  </span>
<a name="l00280"></a>00280     FILE *betafile = fopen(betafilename,<span class="stringliteral">&quot;r&quot;</span>);
<a name="l00281"></a>00281     <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#abb04c4b2a05ec32688ab43103dac8682">have_beta</a> = <span class="keyword">false</span>;
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (betafile != NULL) <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#abb04c4b2a05ec32688ab43103dac8682">have_beta</a> = <span class="keyword">true</span>;
<a name="l00283"></a>00283     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#abb04c4b2a05ec32688ab43103dac8682">have_beta</a>) {
<a name="l00284"></a>00284       fseek(betafile, 0, SEEK_SET); 
<a name="l00285"></a>00285       fscanf(betafile, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;temp); 
<a name="l00286"></a>00286       <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[NumNodes]; 
<a name="l00287"></a>00287       fgets(buffer, 100, betafile); 
<a name="l00288"></a>00288       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;NumNodes; i++){
<a name="l00289"></a>00289         fgets(buffer, 100, betafile); 
<a name="l00290"></a>00290         sscanf(buffer, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[i]); 
<a name="l00291"></a>00291         <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot;, beta: &quot; &lt;&lt; beta[i] &lt;&lt; std::endl; </span>
<a name="l00292"></a>00292        }
<a name="l00293"></a>00293      }
<a name="l00294"></a>00294  
<a name="l00295"></a>00295   <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aac744b74126ea28181bca1b23e3a9771">elem_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, NumEles, <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>, 0, *comm)); <span class="comment">//Distribute the elements according to the global element IDs</span>
<a name="l00296"></a>00296   <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, NumNodes, <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>, 0, *comm)); <span class="comment">//Distribute the nodes according to the global node IDs </span>
<a name="l00297"></a>00297   <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aa7d3d18fa34a2d19832e1986fad6bb81">basal_face_map</a> = Teuchos::rcp(<span class="keyword">new</span> Epetra_Map(-1, <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6da2f0abf46cbcf97f7f95981ae3012f">NumBasalFaces</a>, <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>, 0, *comm)); <span class="comment">//Distribute the elements according to the basal face IDs</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299   
<a name="l00300"></a>00300   params-&gt;validateParameters(*<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#acbc4a3ae28de1c88964c0408d485a654">getValidDiscretizationParameters</a>(),0);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 
<a name="l00303"></a>00303   std::string ebn=<span class="stringliteral">&quot;Element Block 0&quot;</span>;
<a name="l00304"></a>00304   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(ebn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank() );
<a name="l00305"></a>00305   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a1fe4dbe7e44920f111a80ffd008f1e37">ebNameToIndex</a>[ebn] = 0;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00308"></a>00308 <span class="preprocessor"></span>  stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]);
<a name="l00309"></a>00309 <span class="preprocessor">#endif</span>
<a name="l00310"></a>00310 <span class="preprocessor"></span>
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   std::vector&lt;std::string&gt; nsNames;
<a name="l00313"></a>00313   std::string <a class="code" href="felix__driver_8cpp.html#ab535ad6429f94303bc2e0347bb388e0d">nsn</a>=<span class="stringliteral">&quot;Bottom&quot;</span>;
<a name="l00314"></a>00314   nsNames.push_back(nsn);
<a name="l00315"></a>00315   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00316"></a>00316 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00317"></a>00317 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00318"></a>00318 <span class="preprocessor">#endif</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet0&quot;</span>;
<a name="l00320"></a>00320   nsNames.push_back(nsn);
<a name="l00321"></a>00321   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00322"></a>00322 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00324"></a>00324 <span class="preprocessor">#endif</span>
<a name="l00325"></a>00325 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet1&quot;</span>;
<a name="l00326"></a>00326   nsNames.push_back(nsn);
<a name="l00327"></a>00327   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00328"></a>00328 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00330"></a>00330 <span class="preprocessor">#endif</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet2&quot;</span>;
<a name="l00332"></a>00332   nsNames.push_back(nsn);
<a name="l00333"></a>00333   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00334"></a>00334 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00336"></a>00336 <span class="preprocessor">#endif</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet3&quot;</span>;
<a name="l00338"></a>00338   nsNames.push_back(nsn);
<a name="l00339"></a>00339   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00340"></a>00340 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00341"></a>00341 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00342"></a>00342 <span class="preprocessor">#endif</span>
<a name="l00343"></a>00343 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet4&quot;</span>;
<a name="l00344"></a>00344   nsNames.push_back(nsn);
<a name="l00345"></a>00345   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00346"></a>00346 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00347"></a>00347 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00348"></a>00348 <span class="preprocessor">#endif</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span>  nsn=<span class="stringliteral">&quot;NodeSet5&quot;</span>;
<a name="l00350"></a>00350   nsNames.push_back(nsn);
<a name="l00351"></a>00351   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(nsn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank() );
<a name="l00352"></a>00352 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00353"></a>00353 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[nsn]);
<a name="l00354"></a>00354 <span class="preprocessor">#endif</span>
<a name="l00355"></a>00355 <span class="preprocessor"></span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357   std::vector&lt;std::string&gt; ssNames;
<a name="l00358"></a>00358   std::string ssn=<span class="stringliteral">&quot;Basal&quot;</span>;
<a name="l00359"></a>00359   ssNames.push_back(ssn);
<a name="l00360"></a>00360     <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn] = &amp; <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;declare_part(ssn, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank() );
<a name="l00361"></a>00361 <span class="preprocessor">#ifdef ALBANY_SEACAS</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span>    stk::io::put_io_part_attribute(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn]);
<a name="l00363"></a>00363 <span class="preprocessor">#endif</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span>
<a name="l00365"></a>00365   stk::mesh::fem::set_cell_topology&lt;shards::Hexahedron&lt;8&gt; &gt;(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]);
<a name="l00366"></a>00366   stk::mesh::fem::set_cell_topology&lt;shards::Quadrilateral&lt;4&gt; &gt;(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[ssn]);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a302b929f043c676f028876f393978787">numDim</a> = 3;
<a name="l00369"></a>00369   <span class="keywordtype">int</span> cub = params-&gt;get(<span class="stringliteral">&quot;Cubature Degree&quot;</span>,3);
<a name="l00370"></a>00370   <span class="keywordtype">int</span> worksetSizeMax = params-&gt;get(<span class="stringliteral">&quot;Workset Size&quot;</span>,50);
<a name="l00371"></a>00371   <span class="keywordtype">int</span> worksetSize = this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#a65a072dfa4df218a71f3ea0f88b6fdd2" title="Utility function that uses some integer arithmetic to choose a good worksetSize.">computeWorksetSize</a>(worksetSizeMax, <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aac744b74126ea28181bca1b23e3a9771">elem_map</a>-&gt;NumMyElements());
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="keyword">const</span> CellTopologyData&amp; ctd = *<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;get_cell_topology(*<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]).getCellTopologyData();
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#aa5b51847bf2f760e188e953d00d250e9">meshSpecs</a>[0] = Teuchos::rcp(<span class="keyword">new</span> <a class="code" href="structAlbany_1_1MeshSpecsStruct.html">Albany::MeshSpecsStruct</a>(ctd, numDim, cub,
<a name="l00376"></a>00376                              nsNames, ssNames, worksetSize, <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[0]-&gt;name(),
<a name="l00377"></a>00377                              <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a1fe4dbe7e44920f111a80ffd008f1e37">ebNameToIndex</a>, this-&gt;<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a69d84e0494e6ab2a2c78201c8d5224fa">interleavedOrdering</a>));
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ad41288ad4d183c46cc0ad79770312a8c">00382</a> <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ad41288ad4d183c46cc0ad79770312a8c">Albany::AsciiSTKMeshStruct::~AsciiSTKMeshStruct</a>()
<a name="l00383"></a>00383 {
<a name="l00384"></a>00384   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>; 
<a name="l00385"></a>00385   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a>) <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>; 
<a name="l00386"></a>00386   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a>) <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>; 
<a name="l00387"></a>00387   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>; 
<a name="l00388"></a>00388   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a7bec5cf6839ac267cfa99847113aea00">globalElesID</a>; 
<a name="l00389"></a>00389   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae4984bd1bd9394007ee647b935f6841c">globalNodesID</a>;
<a name="l00390"></a>00390   <span class="keyword">delete</span> [] <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a9864f10b371ff5963024afe9b2949367">basalFacesID</a>; 
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 <span class="keywordtype">void</span>
<a name="l00394"></a><a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aa78687d1670b9e63f417259b13dd8805">00394</a> <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aa78687d1670b9e63f417259b13dd8805">Albany::AsciiSTKMeshStruct::setFieldAndBulkData</a>(
<a name="l00395"></a>00395                                                <span class="keyword">const</span> Teuchos::RCP&lt;const Epetra_Comm&gt;&amp; <a class="code" href="felix__driver_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>,
<a name="l00396"></a>00396                                                <span class="keyword">const</span> Teuchos::RCP&lt;Teuchos::ParameterList&gt;&amp; params,
<a name="l00397"></a>00397                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neq_,
<a name="l00398"></a>00398                                                <span class="keyword">const</span> <a class="code" href="classAlbany_1_1AbstractFieldContainer.html#a2bfe39ada257455a2bbe082a0b743704">AbstractFieldContainer::FieldContainerRequirements</a>&amp; req,
<a name="l00399"></a>00399                                                <span class="keyword">const</span> Teuchos::RCP&lt;Albany::StateInfoStruct&gt;&amp; <a class="code" href="InterfaceTry_8cpp.html#a22a797db574d6de7b11c63d19b59ce22">sis</a>,
<a name="l00400"></a>00400                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> worksetSize)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#ae82d1109009b447cbc774991cd23d8dd">SetupFieldData</a>(comm, neq_, req, sis, worksetSize);
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;commit();
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;modification_begin(); <span class="comment">// Begin modifying the mesh</span>
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   stk::mesh::PartVector nodePartVec;
<a name="l00409"></a>00409   stk::mesh::PartVector singlePartVec(1);
<a name="l00410"></a>00410   stk::mesh::PartVector emptyPartVec;
<a name="l00411"></a>00411 <span class="preprocessor">#ifdef OUTPUT_TO_SCREEN</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>  *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;elem_map # elements: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aac744b74126ea28181bca1b23e3a9771">elem_map</a>-&gt;NumMyElements() &lt;&lt; std::endl; 
<a name="l00413"></a>00413   *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;node_map # elements: &quot;</span> &lt;&lt; <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;NumMyElements() &lt;&lt; std::endl;
<a name="l00414"></a>00414 <span class="preprocessor">#endif </span>
<a name="l00415"></a>00415 <span class="preprocessor"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ebNo = 0; <span class="comment">//element block #??? </span>
<a name="l00416"></a>00416   <span class="keywordtype">int</span> sideID = 0;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#ab29b7b67367d394e0364838c6e3fcf73">AbstractSTKFieldContainer::VectorFieldType</a>* coordinates_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getCoordinatesField();
<a name="l00419"></a>00419   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* surfaceHeight_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getSurfaceHeightField();
<a name="l00420"></a>00420   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* flowFactor_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getFlowFactorField();
<a name="l00421"></a>00421   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* temperature_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getTemperatureField();
<a name="l00422"></a>00422   <a class="code" href="classAlbany_1_1AbstractSTKFieldContainer.html#a0c9ac743a450b8ba1f101e7d1c0507d3">AbstractSTKFieldContainer::ScalarFieldType</a>* basal_friction_field = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#aeb01f5da92ae994535ad182db65d0841">fieldContainer</a>-&gt;getBasalFrictionField();
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <span class="keywordflow">if</span>(!surfaceHeight_field) 
<a name="l00425"></a>00425      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a> = <span class="keyword">false</span>;
<a name="l00426"></a>00426   <span class="keywordflow">if</span>(!flowFactor_field) 
<a name="l00427"></a>00427      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a694c5e919d741eacad2afcc24b16de39">have_flwa</a> = <span class="keyword">false</span>;
<a name="l00428"></a>00428   <span class="keywordflow">if</span>(!temperature_field) 
<a name="l00429"></a>00429      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a49aecf489f410be1f35b37b5e1151448">have_temp</a> = <span class="keyword">false</span>;
<a name="l00430"></a>00430   <span class="keywordflow">if</span>(!basal_friction_field) 
<a name="l00431"></a>00431      <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#abb04c4b2a05ec32688ab43103dac8682">have_beta</a> = <span class="keyword">false</span>;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aac744b74126ea28181bca1b23e3a9771">elem_map</a>-&gt;NumMyElements(); i++) {
<a name="l00434"></a>00434      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aac744b74126ea28181bca1b23e3a9771">elem_map</a>-&gt;GID(i);
<a name="l00435"></a>00435      <span class="comment">//std::cout &lt;&lt; &quot;elem_GID: &quot; &lt;&lt; elem_GID &lt;&lt; std::endl; </span>
<a name="l00436"></a>00436      stk::mesh::EntityId elem_id = (stk::mesh::EntityId) elem_GID;
<a name="l00437"></a>00437      singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a7f5a8f068baee4ccb3b557d0ea267b4a">partVec</a>[ebNo];
<a name="l00438"></a>00438      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; elem  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank(), 1+elem_id, singlePartVec);
<a name="l00439"></a>00439      <span class="comment">//I am assuming the ASCII mesh is 1-based not 0-based, so no need to add 1 for STK mesh </span>
<a name="l00440"></a>00440      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0], nodePartVec);
<a name="l00441"></a>00441      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1], nodePartVec);
<a name="l00442"></a>00442      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2], nodePartVec);
<a name="l00443"></a>00443      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][3], nodePartVec);
<a name="l00444"></a>00444      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4], nodePartVec);
<a name="l00445"></a>00445      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][5], nodePartVec);
<a name="l00446"></a>00446      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][6], nodePartVec);
<a name="l00447"></a>00447      <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnodeb = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][7], nodePartVec);
<a name="l00448"></a>00448      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, llnode, 0);
<a name="l00449"></a>00449      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, lrnode, 1);
<a name="l00450"></a>00450      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, urnode, 2);
<a name="l00451"></a>00451      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, ulnode, 3);
<a name="l00452"></a>00452      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, llnodeb, 4);
<a name="l00453"></a>00453      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, lrnodeb, 5);
<a name="l00454"></a>00454      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, urnodeb, 6);
<a name="l00455"></a>00455      <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, ulnodeb, 7);
<a name="l00456"></a>00456     
<a name="l00457"></a>00457 
<a name="l00458"></a>00458      <span class="keywordtype">double</span>* coord;
<a name="l00459"></a>00459      <span class="keywordtype">int</span> node_GID;
<a name="l00460"></a>00460      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node_LID;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1;
<a name="l00463"></a>00463      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00464"></a>00464      coord = stk::mesh::field_data(*coordinates_field, llnode);
<a name="l00465"></a>00465      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00466"></a>00466 
<a name="l00467"></a>00467      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1]-1;
<a name="l00468"></a>00468      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00469"></a>00469      coord = stk::mesh::field_data(*coordinates_field, lrnode);
<a name="l00470"></a>00470      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00471"></a>00471 
<a name="l00472"></a>00472      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2]-1;
<a name="l00473"></a>00473      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00474"></a>00474      coord = stk::mesh::field_data(*coordinates_field, urnode);
<a name="l00475"></a>00475      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00476"></a>00476 
<a name="l00477"></a>00477      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][3]-1;
<a name="l00478"></a>00478      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00479"></a>00479      coord = stk::mesh::field_data(*coordinates_field, ulnode);
<a name="l00480"></a>00480      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00481"></a>00481 
<a name="l00482"></a>00482      coord = stk::mesh::field_data(*coordinates_field, llnodeb);
<a name="l00483"></a>00483      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4]-1;
<a name="l00484"></a>00484      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00485"></a>00485      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00486"></a>00486 
<a name="l00487"></a>00487      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][5]-1;
<a name="l00488"></a>00488      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00489"></a>00489      coord = stk::mesh::field_data(*coordinates_field, lrnodeb);
<a name="l00490"></a>00490      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00491"></a>00491 
<a name="l00492"></a>00492      coord = stk::mesh::field_data(*coordinates_field, urnodeb);
<a name="l00493"></a>00493      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][6]-1;
<a name="l00494"></a>00494      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00495"></a>00495      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00496"></a>00496 
<a name="l00497"></a>00497      coord = stk::mesh::field_data(*coordinates_field, ulnodeb);
<a name="l00498"></a>00498      node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][7]-1;
<a name="l00499"></a>00499      node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00500"></a>00500      coord[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][0];   coord[1] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][1];   coord[2] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[node_LID][2];
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="preprocessor">#ifdef ALBANY_FELIX</span>
<a name="l00503"></a>00503 <span class="preprocessor"></span>     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae3443e10d6ad7468656205047725dc8e">have_sh</a>) {
<a name="l00504"></a>00504        <span class="keywordtype">double</span>* sHeight;
<a name="l00505"></a>00505        sHeight = stk::mesh::field_data(*surfaceHeight_field, llnode);
<a name="l00506"></a>00506        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1;
<a name="l00507"></a>00507        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00508"></a>00508        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00509"></a>00509 
<a name="l00510"></a>00510        sHeight = stk::mesh::field_data(*surfaceHeight_field, lrnode);
<a name="l00511"></a>00511        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1]-1;
<a name="l00512"></a>00512        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00513"></a>00513        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00514"></a>00514 
<a name="l00515"></a>00515        sHeight = stk::mesh::field_data(*surfaceHeight_field, urnode);
<a name="l00516"></a>00516        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2]-1;
<a name="l00517"></a>00517        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00518"></a>00518        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00519"></a>00519 
<a name="l00520"></a>00520        sHeight = stk::mesh::field_data(*surfaceHeight_field, ulnode);
<a name="l00521"></a>00521        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][3]-1;
<a name="l00522"></a>00522        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00523"></a>00523        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00524"></a>00524 
<a name="l00525"></a>00525        sHeight = stk::mesh::field_data(*surfaceHeight_field, llnodeb);
<a name="l00526"></a>00526        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4]-1;
<a name="l00527"></a>00527        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00528"></a>00528        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00529"></a>00529 
<a name="l00530"></a>00530        sHeight = stk::mesh::field_data(*surfaceHeight_field, lrnodeb);
<a name="l00531"></a>00531        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][5]-1;
<a name="l00532"></a>00532        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00533"></a>00533        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00534"></a>00534 
<a name="l00535"></a>00535        sHeight = stk::mesh::field_data(*surfaceHeight_field, urnodeb);
<a name="l00536"></a>00536        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][6]-1;
<a name="l00537"></a>00537        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00538"></a>00538        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00539"></a>00539 
<a name="l00540"></a>00540        sHeight = stk::mesh::field_data(*surfaceHeight_field, ulnodeb);
<a name="l00541"></a>00541        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][7]-1;
<a name="l00542"></a>00542        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00543"></a>00543        sHeight[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b573b61f8319e49537b7a98e8c597ea">sh</a>[node_LID];
<a name="l00544"></a>00544      }
<a name="l00545"></a>00545      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a694c5e919d741eacad2afcc24b16de39">have_flwa</a>) {
<a name="l00546"></a>00546        <span class="keywordtype">double</span> *flowFactor = stk::mesh::field_data(*flowFactor_field, elem); 
<a name="l00547"></a>00547        <span class="comment">//i is elem_LID (element local ID);</span>
<a name="l00548"></a>00548        <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt;&quot;, flwa: &quot; &lt;&lt; flwa[i] &lt;&lt; std::endl;  </span>
<a name="l00549"></a>00549        flowFactor[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af4e481afcb2e9d8c2df271525ba5541e">flwa</a>[i]; 
<a name="l00550"></a>00550      }
<a name="l00551"></a>00551      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a49aecf489f410be1f35b37b5e1151448">have_temp</a>) {
<a name="l00552"></a>00552        <span class="keywordtype">double</span> *temperature = stk::mesh::field_data(*temperature_field, elem); 
<a name="l00553"></a>00553        <span class="comment">//i is elem_LID (element local ID);</span>
<a name="l00554"></a>00554        <span class="comment">//*out &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt;&quot;, temp: &quot; &lt;&lt; temperature[i] &lt;&lt; std::endl;  </span>
<a name="l00555"></a>00555        temperature[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a75b26227af61da6a00890d7c776ab1e9">temper</a>[i]; 
<a name="l00556"></a>00556      }
<a name="l00557"></a>00557      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#abb04c4b2a05ec32688ab43103dac8682">have_beta</a>) {
<a name="l00558"></a>00558        <span class="keywordtype">double</span>* bFriction; 
<a name="l00559"></a>00559        bFriction = stk::mesh::field_data(*basal_friction_field, llnode);
<a name="l00560"></a>00560        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1;
<a name="l00561"></a>00561        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00562"></a>00562        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00563"></a>00563 
<a name="l00564"></a>00564        bFriction = stk::mesh::field_data(*basal_friction_field, lrnode);
<a name="l00565"></a>00565        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1]-1;
<a name="l00566"></a>00566        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00567"></a>00567        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00568"></a>00568 
<a name="l00569"></a>00569        bFriction = stk::mesh::field_data(*basal_friction_field, urnode);
<a name="l00570"></a>00570        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2]-1;
<a name="l00571"></a>00571        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00572"></a>00572        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00573"></a>00573 
<a name="l00574"></a>00574        bFriction = stk::mesh::field_data(*basal_friction_field, ulnode);
<a name="l00575"></a>00575        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][3]-1;
<a name="l00576"></a>00576        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00577"></a>00577        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00578"></a>00578 
<a name="l00579"></a>00579        bFriction = stk::mesh::field_data(*basal_friction_field, llnodeb);
<a name="l00580"></a>00580        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4]-1;
<a name="l00581"></a>00581        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00582"></a>00582        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00583"></a>00583 
<a name="l00584"></a>00584        bFriction = stk::mesh::field_data(*basal_friction_field, lrnodeb);
<a name="l00585"></a>00585        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][5]-1;
<a name="l00586"></a>00586        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00587"></a>00587        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00588"></a>00588 
<a name="l00589"></a>00589        bFriction = stk::mesh::field_data(*basal_friction_field, urnodeb);
<a name="l00590"></a>00590        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][6]-1;
<a name="l00591"></a>00591        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00592"></a>00592        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID];
<a name="l00593"></a>00593 
<a name="l00594"></a>00594        bFriction = stk::mesh::field_data(*basal_friction_field, ulnodeb);
<a name="l00595"></a>00595        node_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][7]-1;
<a name="l00596"></a>00596        node_LID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a1b7c1cdd902ed1a489e562e7e316b40e">node_map</a>-&gt;LID(node_GID);
<a name="l00597"></a>00597        bFriction[0] = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#af7d5619f26885c627d4ea5e7ec5c2fab">beta</a>[node_LID]; 
<a name="l00598"></a>00598        }
<a name="l00599"></a>00599 <span class="preprocessor">#endif</span>
<a name="l00600"></a>00600 <span class="preprocessor"></span>
<a name="l00601"></a>00601      <span class="comment">// If first node has z=0 and there is no basal face file provided, identify it as a Basal SS</span>
<a name="l00602"></a>00602      <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a> == <span class="keyword">false</span>) {
<a name="l00603"></a>00603        *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt;<span class="stringliteral">&quot;No bf file specified...  setting basal boundary to z=0 plane...&quot;</span> &lt;&lt; std::endl; 
<a name="l00604"></a>00604        <span class="keywordflow">if</span> ( <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]][2] == 0.0) {
<a name="l00605"></a>00605           <span class="comment">//std::cout &lt;&lt; &quot;sideID: &quot; &lt;&lt; sideID &lt;&lt; std::endl; </span>
<a name="l00606"></a>00606           singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[<span class="stringliteral">&quot;Basal&quot;</span>];
<a name="l00607"></a>00607           stk::mesh::EntityId side_id = (stk::mesh::EntityId)(sideID);
<a name="l00608"></a>00608           sideID++;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610          <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; side  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank(), 1 + side_id, singlePartVec);
<a name="l00611"></a>00611          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, side,  4 <span class="comment">/*local side id*/</span>);
<a name="l00612"></a>00612 
<a name="l00613"></a>00613          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, llnode, 0);
<a name="l00614"></a>00614          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, ulnode, 3);
<a name="l00615"></a>00615          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, urnode, 2);
<a name="l00616"></a>00616          <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, lrnode, 1);
<a name="l00617"></a>00617        }
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1][0] == 0.0) {
<a name="l00621"></a>00621        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet0&quot;</span>];
<a name="l00622"></a>00622        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnode, singlePartVec); <span class="comment">// node 0</span>
<a name="l00623"></a>00623        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnode, singlePartVec); <span class="comment">// 3</span>
<a name="l00624"></a>00624        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnodeb, singlePartVec); <span class="comment">// 4</span>
<a name="l00625"></a>00625        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnodeb, singlePartVec); <span class="comment">// 7</span>
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][1]-1][0] == 1.0) {
<a name="l00628"></a>00628        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet1&quot;</span>];
<a name="l00629"></a>00629        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnode, singlePartVec); <span class="comment">// 1</span>
<a name="l00630"></a>00630        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnode, singlePartVec); <span class="comment">// 2</span>
<a name="l00631"></a>00631        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnodeb, singlePartVec); <span class="comment">// 5</span>
<a name="l00632"></a>00632        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnodeb, singlePartVec); <span class="comment">// 6</span>
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1][1] == 0.0) {
<a name="l00635"></a>00635        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet2&quot;</span>];
<a name="l00636"></a>00636        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnode, singlePartVec); <span class="comment">// 0</span>
<a name="l00637"></a>00637        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnode, singlePartVec); <span class="comment">// 1</span>
<a name="l00638"></a>00638        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnodeb, singlePartVec); <span class="comment">// 4</span>
<a name="l00639"></a>00639        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnodeb, singlePartVec); <span class="comment">// 5</span>
<a name="l00640"></a>00640     }
<a name="l00641"></a>00641     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][2]-1][1] == 1.0) {
<a name="l00642"></a>00642        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet3&quot;</span>];
<a name="l00643"></a>00643        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnode, singlePartVec); <span class="comment">// 3</span>
<a name="l00644"></a>00644        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnode, singlePartVec); <span class="comment">// 2</span>
<a name="l00645"></a>00645        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnodeb, singlePartVec); <span class="comment">// 7</span>
<a name="l00646"></a>00646        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnodeb, singlePartVec); <span class="comment">// 6</span>
<a name="l00647"></a>00647     }
<a name="l00648"></a>00648     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1][2] == 0.0) {
<a name="l00649"></a>00649        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet4&quot;</span>];
<a name="l00650"></a>00650        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnode, singlePartVec); <span class="comment">// 0</span>
<a name="l00651"></a>00651        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnode, singlePartVec); <span class="comment">// 1</span>
<a name="l00652"></a>00652        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnode, singlePartVec); <span class="comment">// 3</span>
<a name="l00653"></a>00653        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnode, singlePartVec); <span class="comment">// 2</span>
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655     <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][4]-1][2] == 1.0) {
<a name="l00656"></a>00656        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;NodeSet5&quot;</span>];
<a name="l00657"></a>00657        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnodeb, singlePartVec); <span class="comment">// 4</span>
<a name="l00658"></a>00658        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnodeb, singlePartVec); <span class="comment">// 5</span>
<a name="l00659"></a>00659        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnodeb, singlePartVec); <span class="comment">// 7</span>
<a name="l00660"></a>00660        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnodeb, singlePartVec); <span class="comment">// 6</span>
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663      <span class="comment">// If first node has z=0, identify it as a Bottom NS</span>
<a name="l00664"></a>00664      <span class="keywordflow">if</span> ( <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a3259c85ec7400912acea910ee9b5619c">xyz</a>[<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a6c2010082523ad496f13fec402f13aa6">eles</a>[i][0]-1][2] == 0.0) {
<a name="l00665"></a>00665        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a2537c7892b3f78ca370d4f6f89e940e7">nsPartVec</a>[<span class="stringliteral">&quot;Bottom&quot;</span>];
<a name="l00666"></a>00666        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(llnode, singlePartVec); <span class="comment">// 0</span>
<a name="l00667"></a>00667        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(lrnode, singlePartVec); <span class="comment">// 1</span>
<a name="l00668"></a>00668        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(ulnode, singlePartVec); <span class="comment">// 3</span>
<a name="l00669"></a>00669        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;change_entity_parts(urnode, singlePartVec); <span class="comment">// 2</span>
<a name="l00670"></a>00670      }
<a name="l00671"></a>00671   }
<a name="l00672"></a>00672   <span class="keywordflow">if</span> (<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a15b8d5137eaecf4645e4b3534d5152a5">have_bf</a> == <span class="keyword">true</span>) {
<a name="l00673"></a>00673     *<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#ae5ab2fc0040ff6495361653b23d02d0f">out</a> &lt;&lt; <span class="stringliteral">&quot;Setting basal surface connectivity from bf file provided...&quot;</span> &lt;&lt; std::endl;  
<a name="l00674"></a>00674     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aa7d3d18fa34a2d19832e1986fad6bb81">basal_face_map</a>-&gt;NumMyElements(); i++) {
<a name="l00675"></a>00675        singlePartVec[0] = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#ae5e5266d1857bf139c408182987ec81d">ssPartVec</a>[<span class="stringliteral">&quot;Basal&quot;</span>];
<a name="l00676"></a>00676        sideID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#aa7d3d18fa34a2d19832e1986fad6bb81">basal_face_map</a>-&gt;GID(i); 
<a name="l00677"></a>00677        stk::mesh::EntityId side_id = (stk::mesh::EntityId)(sideID);
<a name="l00678"></a>00678        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; side  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;side_rank(), 1 + side_id, singlePartVec);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_GID = <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][0];
<a name="l00681"></a>00681        <span class="comment">//std::cout &lt;&lt; &quot;elem_GID: &quot; &lt;&lt; elem_GID &lt;&lt; std::endl; </span>
<a name="l00682"></a>00682        stk::mesh::EntityId elem_id = (stk::mesh::EntityId) elem_GID;
<a name="l00683"></a>00683        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; elem  = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;element_rank(), elem_id, emptyPartVec);
<a name="l00684"></a>00684        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(elem, side,  4 <span class="comment">/*local side id*/</span>);
<a name="l00685"></a>00685        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; llnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][1], nodePartVec);
<a name="l00686"></a>00686        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; lrnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][2], nodePartVec);
<a name="l00687"></a>00687        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; urnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][3], nodePartVec);
<a name="l00688"></a>00688        <a class="code" href="namespaceAAdapt.html#a6e672c66f1cfcf2ba9f8baf4a51e0381">stk::mesh::Entity</a>&amp; ulnode = <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_entity(<a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#abf63f8821561dea275706c29dae5a697">metaData</a>-&gt;node_rank(), <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#a80c87e04399959b2e72528defaf5c5e4">bf</a>[i][4], nodePartVec);
<a name="l00689"></a>00689        
<a name="l00690"></a>00690        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, llnode, 0);
<a name="l00691"></a>00691        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, ulnode, 3);
<a name="l00692"></a>00692        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, urnode, 2);
<a name="l00693"></a>00693        <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;declare_relation(side, lrnode, 1);
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695   }
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   <a class="code" href="structAlbany_1_1AbstractSTKMeshStruct.html#a943f4f4b0d90c74b94e299f5471dbc35">bulkData</a>-&gt;modification_end();
<a name="l00698"></a>00698 }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700 Teuchos::RCP&lt;const Teuchos::ParameterList&gt;
<a name="l00701"></a><a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#acbc4a3ae28de1c88964c0408d485a654">00701</a> <a class="code" href="classAlbany_1_1AsciiSTKMeshStruct.html#acbc4a3ae28de1c88964c0408d485a654">Albany::AsciiSTKMeshStruct::getValidDiscretizationParameters</a>()<span class="keyword"> const</span>
<a name="l00702"></a>00702 <span class="keyword"></span>{
<a name="l00703"></a>00703   Teuchos::RCP&lt;Teuchos::ParameterList&gt; validPL =
<a name="l00704"></a>00704     this-&gt;<a class="code" href="classAlbany_1_1GenericSTKMeshStruct.html#a81cdcb00e08a795989c5ea1b859da13d">getValidGenericSTKParameters</a>(<span class="stringliteral">&quot;Valid ASCII_DiscParams&quot;</span>);
<a name="l00705"></a>00705 
<a name="l00706"></a>00706   <span class="keywordflow">return</span> validPL;
<a name="l00707"></a>00707 }
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 26 2014 18:36:36 for Albany: a Trilinos-based PDE code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
