<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Albany: a Trilinos-based PDE code: PHAL_ComprNSViscosity_Def.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>PHAL_ComprNSViscosity_Def.hpp</h1>  </div>
</div>
<div class="contents">
<a href="PHAL__ComprNSViscosity__Def_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//*****************************************************************//</span>
<a name="l00002"></a>00002 <span class="comment">//    Albany 2.0:  Copyright 2012 Sandia Corporation               //</span>
<a name="l00003"></a>00003 <span class="comment">//    This Software is released under the BSD license detailed     //</span>
<a name="l00004"></a>00004 <span class="comment">//    in the file &quot;license.txt&quot; in the top-level Albany directory  //</span>
<a name="l00005"></a>00005 <span class="comment">//*****************************************************************//</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;Teuchos_TestForException.hpp&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;Phalanx_DataLayout.hpp&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;Sacado.hpp&quot;</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;Intrepid_FunctionSpaceTools.hpp&quot;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="keyword">namespace </span>PHAL {
<a name="l00014"></a>00014 <span class="comment">//**********************************************************************</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> EvalT, <span class="keyword">typename</span> Traits&gt;
<a name="l00017"></a>00017 <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab7085856581e6d63ce2660a1b2ad5771">ComprNSViscosity&lt;EvalT, Traits&gt;::</a>
<a name="l00018"></a><a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab7085856581e6d63ce2660a1b2ad5771">00018</a> <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab7085856581e6d63ce2660a1b2ad5771">ComprNSViscosity</a>(<span class="keyword">const</span> Teuchos::ParameterList&amp; p) :
<a name="l00019"></a>00019   qFluct       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;QP Variable Name&quot;</span>),
<a name="l00020"></a>00020          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Vector Data Layout&quot;</span>) ),
<a name="l00021"></a>00021   qFluctGrad      (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Gradient QP Variable Name&quot;</span>),
<a name="l00022"></a>00022          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Tensor Data Layout&quot;</span>) ),
<a name="l00023"></a>00023   mu          (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Viscosity Mu QP Variable Name&quot;</span>),
<a name="l00024"></a>00024          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ),  
<a name="l00025"></a>00025   kappa       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Viscosity Kappa QP Variable Name&quot;</span>),
<a name="l00026"></a>00026          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00027"></a>00027   lambda       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Viscosity Lambda QP Variable Name&quot;</span>),
<a name="l00028"></a>00028          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00029"></a>00029   <a class="code" href="namespaceFELIX.html#a575b5be5528cdb3a86b4e4932f30ff8e">tau11</a>          (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau11 QP Variable Name&quot;</span>),
<a name="l00030"></a>00030          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ),  
<a name="l00031"></a>00031   <a class="code" href="namespaceFELIX.html#aa27df344c7b293a011b39b9ce30e1521">tau12</a>       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau12 QP Variable Name&quot;</span>),
<a name="l00032"></a>00032          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00033"></a>00033   <a class="code" href="namespaceFELIX.html#a7f60730c4227137a4ec20c197f235b7a">tau13</a>       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau13 QP Variable Name&quot;</span>),
<a name="l00034"></a>00034          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00035"></a>00035   <a class="code" href="namespaceFELIX.html#afc03e7c46b523eee294e19fb195b552f">tau22</a>       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau22 QP Variable Name&quot;</span>),
<a name="l00036"></a>00036          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00037"></a>00037   <a class="code" href="namespaceFELIX.html#a570ed8183e906e11e05ed7049ea899a1">tau23</a>       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau23 QP Variable Name&quot;</span>),
<a name="l00038"></a>00038          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ), 
<a name="l00039"></a>00039   <a class="code" href="namespaceFELIX.html#a5286e59cda41e21b4df17b388f2f8bc6">tau33</a>       (p.get&lt;std::string&gt;                   (<span class="stringliteral">&quot;Stress Tau33 QP Variable Name&quot;</span>),
<a name="l00040"></a>00040          p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Scalar Data Layout&quot;</span>) ) 
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   Teuchos::ParameterList* visc_list = 
<a name="l00043"></a>00043    p.get&lt;Teuchos::ParameterList*&gt;(<span class="stringliteral">&quot;Parameter List&quot;</span>);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045   std::string viscType = visc_list-&gt;get(<span class="stringliteral">&quot;Type&quot;</span>, <span class="stringliteral">&quot;Constant&quot;</span>);
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <span class="keywordflow">if</span> (viscType == <span class="stringliteral">&quot;Constant&quot;</span>){ 
<a name="l00048"></a>00048     std::cout &lt;&lt; <span class="stringliteral">&quot;Constant viscosity!&quot;</span> &lt;&lt; std::endl;
<a name="l00049"></a>00049     <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7d3a327e9875b32f2f3201ea12189a24">visc_type</a> = CONSTANT;
<a name="l00050"></a>00050   }
<a name="l00051"></a>00051   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (viscType == <span class="stringliteral">&quot;Sutherland&quot;</span>) {
<a name="l00052"></a>00052    std::cout &lt;&lt; <span class="stringliteral">&quot;Sutherland viscosity!&quot;</span> &lt;&lt; std::endl; 
<a name="l00053"></a>00053     <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7d3a327e9875b32f2f3201ea12189a24">visc_type</a> = SUTHERLAND; 
<a name="l00054"></a>00054   }
<a name="l00055"></a>00055   
<a name="l00056"></a>00056   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#afdc22da6c6da5aca29b252a90dffe905">muref</a> = visc_list-&gt;get(<span class="stringliteral">&quot;Mu_ref&quot;</span>, 1.0); 
<a name="l00057"></a>00057   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ac9d6b52cf5247e83700f4cae0c1aa0d5">kapparef</a> = visc_list-&gt;get(<span class="stringliteral">&quot;Kappa_ref&quot;</span>, 1.0);  
<a name="l00058"></a>00058   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a6b5f02f309126b8423a60ebcc3ef0dae">Tref</a> = visc_list-&gt;get(<span class="stringliteral">&quot;T_ref&quot;</span>, 1.0);  
<a name="l00059"></a>00059   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab04f056a48590147533276016d9b8f88">Pr</a> = visc_list-&gt;get(<span class="stringliteral">&quot;Prandtl number Pr&quot;</span>, 0.72); 
<a name="l00060"></a>00060   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a135e4e61bc1f0e44fb7eaed62a43cc44">Cp</a> = visc_list-&gt;get(<span class="stringliteral">&quot;Specific heat Cp&quot;</span>, 1.0); 
<a name="l00061"></a>00061   
<a name="l00062"></a>00062   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#af17035d3d6c994a9ef76230e2088f53f">coordVec</a> = PHX::MDField&lt;MeshScalarT,Cell,QuadPoint,Dim&gt;(
<a name="l00063"></a>00063             p.get&lt;std::string&gt;(<span class="stringliteral">&quot;Coordinate Vector Name&quot;</span>),
<a name="l00064"></a>00064       p.get&lt;Teuchos::RCP&lt;PHX::DataLayout&gt; &gt;(<span class="stringliteral">&quot;QP Gradient Data Layout&quot;</span>) );
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   this-&gt;addDependentField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad542760936f279581f12e38164e07c3d">qFluct</a>);
<a name="l00067"></a>00067   this-&gt;addDependentField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>);
<a name="l00068"></a>00068   this-&gt;addDependentField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#af17035d3d6c994a9ef76230e2088f53f">coordVec</a>);
<a name="l00069"></a>00069   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>);
<a name="l00070"></a>00070   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#af699dc145235b3f49df1e0d562bdaae4">kappa</a>);
<a name="l00071"></a>00071   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>);
<a name="l00072"></a>00072   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a521d72fdc99f65f184606ad964fd9581">tau11</a>);
<a name="l00073"></a>00073   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9b54ee778f2b71b464d073a5a5da88a3">tau12</a>);
<a name="l00074"></a>00074   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad6b646fc1bfbadae6572afa4164a5a30">tau13</a>);
<a name="l00075"></a>00075   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a1bb8f3a3c73f79fee52764cbda1def98">tau22</a>);
<a name="l00076"></a>00076   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a350c03662261a1255e6d48e47ee6cf59">tau23</a>);
<a name="l00077"></a>00077   this-&gt;addEvaluatedField(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a4c503b8026f67b0a6e5f940993a8cd7f">tau33</a>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   std::vector&lt;PHX::DataLayout::size_type&gt; dims;
<a name="l00080"></a>00080   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>.fieldTag().dataLayout().dimensions(dims);
<a name="l00081"></a>00081   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a>   = dims[2];
<a name="l00082"></a>00082   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a69b66d217d26c27450c0415a51d3075f">numDims</a>  = dims[3];
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad542760936f279581f12e38164e07c3d">qFluct</a>.fieldTag().dataLayout().dimensions(dims);
<a name="l00085"></a>00085   <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a28f53547442315757b7ce19c78f59066">vecDim</a>  = dims[2];
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   std::cout &lt;&lt; <span class="stringliteral">&quot;vecdim in viscosity evaluator: &quot;</span> &lt;&lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a28f53547442315757b7ce19c78f59066">vecDim</a> &lt;&lt; std::endl; 
<a name="l00088"></a>00088   std::cout &lt;&lt; <span class="stringliteral">&quot;numDims in viscosity evaluator: &quot;</span> &lt;&lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a69b66d217d26c27450c0415a51d3075f">numDims</a> &lt;&lt; std::endl; 
<a name="l00089"></a>00089   std::cout &lt;&lt; <span class="stringliteral">&quot;numQPs in viscosity evaluator: &quot;</span> &lt;&lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a> &lt;&lt; std::endl; 
<a name="l00090"></a>00090   std::cout &lt;&lt; <span class="stringliteral">&quot;Mu_ref: &quot;</span> &lt;&lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#afdc22da6c6da5aca29b252a90dffe905">muref</a> &lt;&lt; std::endl; 
<a name="l00091"></a>00091   std::cout &lt;&lt; <span class="stringliteral">&quot;Kappa_ref: &quot;</span> &lt;&lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ac9d6b52cf5247e83700f4cae0c1aa0d5">kapparef</a> &lt;&lt; std::endl; 
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   this-&gt;setName(<span class="stringliteral">&quot;ComprNSViscosity&quot;</span>+PHX::TypeString&lt;EvalT&gt;::value);
<a name="l00094"></a>00094 }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">//**********************************************************************</span>
<a name="l00097"></a>00097 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> EvalT, <span class="keyword">typename</span> Traits&gt;
<a name="l00098"></a>00098 <span class="keywordtype">void</span> <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab5964eaa5d29465b774adc64794acf4e">ComprNSViscosity&lt;EvalT, Traits&gt;::</a>
<a name="l00099"></a><a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab5964eaa5d29465b774adc64794acf4e">00099</a> <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab5964eaa5d29465b774adc64794acf4e">postRegistrationSetup</a>(<span class="keyword">typename</span> Traits::SetupData d,
<a name="l00100"></a>00100                       PHX::FieldManager&lt;Traits&gt;&amp; fm)
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad542760936f279581f12e38164e07c3d">qFluct</a>,fm);
<a name="l00103"></a>00103   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>,fm);
<a name="l00104"></a>00104   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>,fm); 
<a name="l00105"></a>00105   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#af699dc145235b3f49df1e0d562bdaae4">kappa</a>,fm); 
<a name="l00106"></a>00106   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>,fm); 
<a name="l00107"></a>00107   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#af17035d3d6c994a9ef76230e2088f53f">coordVec</a>,fm); 
<a name="l00108"></a>00108   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a521d72fdc99f65f184606ad964fd9581">tau11</a>,fm); 
<a name="l00109"></a>00109   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9b54ee778f2b71b464d073a5a5da88a3">tau12</a>,fm); 
<a name="l00110"></a>00110   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad6b646fc1bfbadae6572afa4164a5a30">tau13</a>,fm); 
<a name="l00111"></a>00111   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a1bb8f3a3c73f79fee52764cbda1def98">tau22</a>,fm); 
<a name="l00112"></a>00112   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a350c03662261a1255e6d48e47ee6cf59">tau23</a>,fm); 
<a name="l00113"></a>00113   this-&gt;utils.setFieldData(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a4c503b8026f67b0a6e5f940993a8cd7f">tau33</a>,fm); 
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="comment">//**********************************************************************</span>
<a name="l00117"></a>00117 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> EvalT, <span class="keyword">typename</span> Traits&gt;
<a name="l00118"></a>00118 <span class="keywordtype">void</span> <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9bb99781f33054adaacf1451536e2b9c">ComprNSViscosity&lt;EvalT, Traits&gt;::</a>
<a name="l00119"></a><a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9bb99781f33054adaacf1451536e2b9c">00119</a> <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9bb99781f33054adaacf1451536e2b9c">evaluateFields</a>(<span class="keyword">typename</span> Traits::EvalData workset)
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121   <span class="comment">//Visocisity coefficients</span>
<a name="l00122"></a>00122   <span class="keywordflow">if</span> (<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7d3a327e9875b32f2f3201ea12189a24">visc_type</a> == <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a19ccb475cce3ce30e24cfa3cb41f4a78a13da2e0bc28d8150ae3c0879020773d2">CONSTANT</a>){
<a name="l00123"></a>00123     <span class="keywordflow">for</span> (std::size_t cell=0; cell &lt; workset.numCells; ++cell) {
<a name="l00124"></a>00124       <span class="keywordflow">for</span> (std::size_t qp=0; qp &lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a>; ++qp) {
<a name="l00125"></a>00125         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp) = 1.0;
<a name="l00126"></a>00126         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#af699dc145235b3f49df1e0d562bdaae4">kappa</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a135e4e61bc1f0e44fb7eaed62a43cc44">Cp</a>/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab04f056a48590147533276016d9b8f88">Pr</a>/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ac9d6b52cf5247e83700f4cae0c1aa0d5">kapparef</a>; 
<a name="l00127"></a>00127         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp) = 1.0/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#afdc22da6c6da5aca29b252a90dffe905">muref</a>; <span class="comment">//non-dimensionalize mu </span>
<a name="l00128"></a>00128         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp) = -2.0/3.0*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp); <span class="comment">//Stokes&#39; hypothesis </span>
<a name="l00129"></a>00129       }
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131   }
<a name="l00132"></a>00132   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7d3a327e9875b32f2f3201ea12189a24">visc_type</a> == <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a19ccb475cce3ce30e24cfa3cb41f4a78a6613c010c65f66cd4a293347a62352fe">SUTHERLAND</a>){
<a name="l00133"></a>00133     <span class="keywordflow">for</span> (std::size_t cell=0; cell &lt; workset.numCells; ++cell) {
<a name="l00134"></a>00134       <span class="keywordflow">for</span> (std::size_t qp=0; qp &lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a>; ++qp) {
<a name="l00135"></a>00135         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a04c0f73a7adb71b869c41de177c5d742">ScalarT</a> T = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad542760936f279581f12e38164e07c3d">qFluct</a>(cell,qp,<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a28f53547442315757b7ce19c78f59066">vecDim</a>-1)*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a6b5f02f309126b8423a60ebcc3ef0dae">Tref</a>; <span class="comment">//temperature (dimensional)</span>
<a name="l00136"></a>00136         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp) = (1.458e-6)*sqrt(T*T*T)/(T + 110.4); <span class="comment">//mu = (1.458e-6)*T^(1/5)/(T + 110.4) </span>
<a name="l00137"></a>00137         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#af699dc145235b3f49df1e0d562bdaae4">kappa</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a135e4e61bc1f0e44fb7eaed62a43cc44">Cp</a>/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab04f056a48590147533276016d9b8f88">Pr</a>/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#ac9d6b52cf5247e83700f4cae0c1aa0d5">kapparef</a>; 
<a name="l00138"></a>00138         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)/<a class="code" href="classPHAL_1_1ComprNSViscosity.html#afdc22da6c6da5aca29b252a90dffe905">muref</a>; <span class="comment">//non-dimensionalize mu </span>
<a name="l00139"></a>00139         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp) = -2.0/3.0*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp); <span class="comment">//Stokes&#39; hypothesis</span>
<a name="l00140"></a>00140       }
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142   }
<a name="l00143"></a>00143   <span class="comment">//Viscous stresses</span>
<a name="l00144"></a>00144   <span class="keywordflow">for</span> (std::size_t cell=0; cell &lt; workset.numCells; ++cell) {
<a name="l00145"></a>00145     <span class="keywordflow">for</span> (std::size_t qp=0; qp &lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a>; ++qp) {
<a name="l00146"></a>00146       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a521d72fdc99f65f184606ad964fd9581">tau11</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*2.0*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,0) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,0) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,1)); <span class="comment">//mu*2*du/dx + lambda*div(u) </span>
<a name="l00147"></a>00147       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a9b54ee778f2b71b464d073a5a5da88a3">tau12</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,1) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,0)); <span class="comment">//mu*(du/dy + dv/dx)</span>
<a name="l00148"></a>00148       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad6b646fc1bfbadae6572afa4164a5a30">tau13</a>(cell,qp) = 0.0; 
<a name="l00149"></a>00149       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a1bb8f3a3c73f79fee52764cbda1def98">tau22</a>(cell,qp) = <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*2.0*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,1) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,0) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,1)); <span class="comment">//mu*2*dv/dy + lambda*div(u) </span>
<a name="l00150"></a>00150       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a350c03662261a1255e6d48e47ee6cf59">tau23</a>(cell,qp) = 0.0; 
<a name="l00151"></a>00151       <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a4c503b8026f67b0a6e5f940993a8cd7f">tau33</a>(cell,qp) = 0.0; 
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153   }
<a name="l00154"></a>00154   <span class="keywordflow">if</span> (<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a69b66d217d26c27450c0415a51d3075f">numDims</a> == 3) {<span class="comment">//3D case </span>
<a name="l00155"></a>00155     <span class="keywordflow">for</span> (std::size_t cell=0; cell &lt; workset.numCells; ++cell) {
<a name="l00156"></a>00156       <span class="keywordflow">for</span> (std::size_t qp=0; qp &lt; <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ae8983847995ca466dd1d9c87dcc8476d">numQPs</a>; ++qp) {
<a name="l00157"></a>00157         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a521d72fdc99f65f184606ad964fd9581">tau11</a>(cell,qp) += <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp)*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,3,2); <span class="comment">//+lambda*dw/dz </span>
<a name="l00158"></a>00158         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad6b646fc1bfbadae6572afa4164a5a30">tau13</a>(cell,qp) += <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,2) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,3,0)); <span class="comment">//mu*(du/dz + dw/dx)</span>
<a name="l00159"></a>00159         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a1bb8f3a3c73f79fee52764cbda1def98">tau22</a>(cell,qp) += <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp)*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,3,2); <span class="comment">//+lambda*dw/dz </span>
<a name="l00160"></a>00160         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a350c03662261a1255e6d48e47ee6cf59">tau23</a>(cell,qp) += <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,3) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,3,1)); <span class="comment">//mu*(dv/dz + dw/dy)</span>
<a name="l00161"></a>00161         <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a4c503b8026f67b0a6e5f940993a8cd7f">tau33</a>(cell,qp) += <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a7a45cf23a822f8ee8bf637515d3c3aec">mu</a>(cell,qp)*2.0*<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,3,2) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ab076e859d34ef86041ecd1a948ffa9aa">lambda</a>(cell,qp)*(<a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,1,0) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#a820ed7fb30957ca01e7a7be94c11b137">qFluctGrad</a>(cell,qp,2,1) + <a class="code" href="classPHAL_1_1ComprNSViscosity.html#ad542760936f279581f12e38164e07c3d">qFluct</a>(cell,qp,3,2)); <span class="comment">//mu*2*dw/dz + lambda*div(u) </span>
<a name="l00162"></a>00162       }
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164   }
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Mar 26 2014 18:36:40 for Albany: a Trilinos-based PDE code by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
